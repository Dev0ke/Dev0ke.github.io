<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CryptoHack Writeup | devoke's blog</title><meta name="author" content="devoke"><meta name="copyright" content="devoke"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="CryptoHack – A fun free platform for learning cryptography的一些题解，比较久远。 MathSize and Basis计算向量的模$$|v| &amp;#x3D; \sqrt{4^2+6^2+5^2+2^2}$$ Gram SchmidtGram-S"><link rel="shortcut icon" href="https://s2.loli.net/2024/02/20/B6y8wIH5iltGxP9.png"><link rel="canonical" href="http://example.com/2021/08/11/WriteUp/CryptoHack-Writeup/index.html"><link rel="preconnect"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/"><link rel="stylesheet" href="/" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: '/',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: ,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CryptoHack Writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-02-20 10:02:06'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2024/05/04/Zav4zFVukLJMBKI.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2024/02/20/h3iOcSdRqel45vD.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="devoke's blog"><span class="site-name">devoke's blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CryptoHack Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-11T08:02:53.000Z" title="发表于 2021-08-11 16:02:53">2021-08-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-02-20T02:02:06.000Z" title="更新于 2024-02-20 10:02:06">2024-02-20</time></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://cryptohack.org/">CryptoHack – A fun free platform for learning cryptography</a>的一些题解，比较久远。</p>
<h1 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h1><h3 id="Size-and-Basis"><a href="#Size-and-Basis" class="headerlink" title="Size and Basis"></a>Size and Basis</h3><p>计算向量的模<br>$$<br>|v| &#x3D; \sqrt{4^2+6^2+5^2+2^2}<br>$$</p>
<h3 id="Gram-Schmidt"><a href="#Gram-Schmidt" class="headerlink" title="Gram Schmidt"></a>Gram Schmidt</h3><p>Gram-Schmidt正交化方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy.matrices <span class="keyword">import</span> Matrix,GramSchmidt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">v = np.array([[<span class="number">4</span>,<span class="number">1</span>,<span class="number">3</span>,-<span class="number">1</span>],[<span class="number">2</span>,<span class="number">1</span>,-<span class="number">3</span>,<span class="number">4</span>],[<span class="number">1</span>,<span class="number">0</span>,-<span class="number">2</span>,<span class="number">7</span>],[<span class="number">6</span>, <span class="number">2</span>, <span class="number">9</span>, -<span class="number">5</span>]])</span><br><span class="line">v = [Matrix(col) <span class="keyword">for</span> col <span class="keyword">in</span> v]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">eval</span>(<span class="built_in">str</span>(GramSchmidt(v)[<span class="number">3</span>][<span class="number">1</span>])))</span><br><span class="line"></span><br><span class="line"><span class="comment">#0.91610738</span></span><br></pre></td></tr></table></figure>



<h1 id="Block"><a href="#Block" class="headerlink" title="Block"></a>Block</h1><p>bijection 双射</p>
<h3 id="Structure-of-AES"><a href="#Structure-of-AES" class="headerlink" title="Structure of AES"></a>Structure of AES</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">matrix</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&quot;&quot;</span>.join(<span class="built_in">bytearray</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> matrix)</span><br><span class="line">	<span class="comment">#bytes(sum(matrix,[]))</span></span><br><span class="line"><span class="comment">#crypto&#123;inmatrix&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">N_ROUNDS = <span class="number">10</span></span><br><span class="line">s_box = (</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">)</span><br><span class="line">inv_s_box = (</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6A</span>, <span class="number">0xD5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x38</span>, <span class="number">0xBF</span>, <span class="number">0x40</span>, <span class="number">0xA3</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0xF3</span>, <span class="number">0xD7</span>, <span class="number">0xFB</span>,</span><br><span class="line">    <span class="number">0x7C</span>, <span class="number">0xE3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9B</span>, <span class="number">0x2F</span>, <span class="number">0xFF</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8E</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xC4</span>, <span class="number">0xDE</span>, <span class="number">0xE9</span>, <span class="number">0xCB</span>,</span><br><span class="line">    <span class="number">0x54</span>, <span class="number">0x7B</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xA6</span>, <span class="number">0xC2</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0xEE</span>, <span class="number">0x4C</span>, <span class="number">0x95</span>, <span class="number">0x0B</span>, <span class="number">0x42</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x4E</span>,</span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x2E</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xD9</span>, <span class="number">0x24</span>, <span class="number">0xB2</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0xA2</span>, <span class="number">0x49</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0xD1</span>, <span class="number">0x25</span>,</span><br><span class="line">    <span class="number">0x72</span>, <span class="number">0xF8</span>, <span class="number">0xF6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xD4</span>, <span class="number">0xA4</span>, <span class="number">0x5C</span>, <span class="number">0xCC</span>, <span class="number">0x5D</span>, <span class="number">0x65</span>, <span class="number">0xB6</span>, <span class="number">0x92</span>,</span><br><span class="line">    <span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xFD</span>, <span class="number">0xED</span>, <span class="number">0xB9</span>, <span class="number">0xDA</span>, <span class="number">0x5E</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>, <span class="number">0x9D</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x00</span>, <span class="number">0x8C</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x0A</span>, <span class="number">0xF7</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xB8</span>, <span class="number">0xB3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0x1E</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x3F</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0xAF</span>, <span class="number">0xBD</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8A</span>, <span class="number">0x6B</span>,</span><br><span class="line">    <span class="number">0x3A</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4F</span>, <span class="number">0x67</span>, <span class="number">0xDC</span>, <span class="number">0xEA</span>, <span class="number">0x97</span>, <span class="number">0xF2</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x96</span>, <span class="number">0xAC</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xE7</span>, <span class="number">0xAD</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xE2</span>, <span class="number">0xF9</span>, <span class="number">0x37</span>, <span class="number">0xE8</span>, <span class="number">0x1C</span>, <span class="number">0x75</span>, <span class="number">0xDF</span>, <span class="number">0x6E</span>,</span><br><span class="line">    <span class="number">0x47</span>, <span class="number">0xF1</span>, <span class="number">0x1A</span>, <span class="number">0x71</span>, <span class="number">0x1D</span>, <span class="number">0x29</span>, <span class="number">0xC5</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0xB7</span>, <span class="number">0x62</span>, <span class="number">0x0E</span>, <span class="number">0xAA</span>, <span class="number">0x18</span>, <span class="number">0xBE</span>, <span class="number">0x1B</span>,</span><br><span class="line">    <span class="number">0xFC</span>, <span class="number">0x56</span>, <span class="number">0x3E</span>, <span class="number">0x4B</span>, <span class="number">0xC6</span>, <span class="number">0xD2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9A</span>, <span class="number">0xDB</span>, <span class="number">0xC0</span>, <span class="number">0xFE</span>, <span class="number">0x78</span>, <span class="number">0xCD</span>, <span class="number">0x5A</span>, <span class="number">0xF4</span>,</span><br><span class="line">    <span class="number">0x1F</span>, <span class="number">0xDD</span>, <span class="number">0xA8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0x31</span>, <span class="number">0xB1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7F</span>, <span class="number">0xA9</span>, <span class="number">0x19</span>, <span class="number">0xB5</span>, <span class="number">0x4A</span>, <span class="number">0x0D</span>, <span class="number">0x2D</span>, <span class="number">0xE5</span>, <span class="number">0x7A</span>, <span class="number">0x9F</span>, <span class="number">0x93</span>, <span class="number">0xC9</span>, <span class="number">0x9C</span>, <span class="number">0xEF</span>,</span><br><span class="line">    <span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0x3B</span>, <span class="number">0x4D</span>, <span class="number">0xAE</span>, <span class="number">0x2A</span>, <span class="number">0xF5</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xEB</span>, <span class="number">0xBB</span>, <span class="number">0x3C</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x04</span>, <span class="number">0x7E</span>, <span class="number">0xBA</span>, <span class="number">0x77</span>, <span class="number">0xD6</span>, <span class="number">0x26</span>, <span class="number">0xE1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0C</span>, <span class="number">0x7D</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>] =s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>] =s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>] =s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_single_column</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="comment"># see Sec 4.1.2 in The Design of Rijndael</span></span><br><span class="line">    t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">    u = a[<span class="number">0</span>]</span><br><span class="line">    a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">    a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">    a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">    a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        mix_single_column(s[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="comment"># see Sec 4.1.3 in The Design of Rijndael</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        u = xtime(xtime(s[i][<span class="number">0</span>] ^ s[i][<span class="number">2</span>]))</span><br><span class="line">        v = xtime(xtime(s[i][<span class="number">1</span>] ^ s[i][<span class="number">3</span>]))</span><br><span class="line">        s[i][<span class="number">0</span>] ^= u</span><br><span class="line">        s[i][<span class="number">1</span>] ^= v</span><br><span class="line">        s[i][<span class="number">2</span>] ^= u</span><br><span class="line">        s[i][<span class="number">3</span>] ^= v</span><br><span class="line"></span><br><span class="line">    mix_columns(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(text[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text), <span class="number">4</span>)]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">sum</span>(m,[]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">s, k</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j]^=k[i][j]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sub</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = inv_s_box[s[i][j]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">expand_key</span>(<span class="params">master_key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Expands and returns a list of key matrices for the given master_key.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Round constants https://en.wikipedia.org/wiki/AES_key_schedule#Round_constants</span></span><br><span class="line">    r_con = (</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>,</span><br><span class="line">        <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>, <span class="number">0x6C</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x4D</span>, <span class="number">0x9A</span>,</span><br><span class="line">        <span class="number">0x2F</span>, <span class="number">0x5E</span>, <span class="number">0xBC</span>, <span class="number">0x63</span>, <span class="number">0xC6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6A</span>,</span><br><span class="line">        <span class="number">0xD4</span>, <span class="number">0xB3</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0xEF</span>, <span class="number">0xC5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>,</span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># Initialize round keys with raw key material.</span></span><br><span class="line">    key_columns = bytes2matrix(master_key)</span><br><span class="line">    iteration_size = <span class="built_in">len</span>(master_key) // <span class="number">4</span></span><br><span class="line">    <span class="comment"># Each iteration has exactly as many columns as the key material.</span></span><br><span class="line">    columns_per_iteration = <span class="built_in">len</span>(key_columns)</span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(key_columns) &lt; (N_ROUNDS + <span class="number">1</span>) * <span class="number">4</span>:</span><br><span class="line">        <span class="comment"># Copy previous word.</span></span><br><span class="line">        word = <span class="built_in">list</span>(key_columns[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Perform schedule_core once every &quot;row&quot;.</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(key_columns) % iteration_size == <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># Circular shift.</span></span><br><span class="line">            word.append(word.pop(<span class="number">0</span>))</span><br><span class="line">            <span class="comment"># Map to S-BOX.</span></span><br><span class="line">            word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word]</span><br><span class="line">            <span class="comment"># XOR with first byte of R-CON, since the others bytes of R-CON are 0.</span></span><br><span class="line">            word[<span class="number">0</span>] ^= r_con[i]</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(master_key) == <span class="number">32</span> <span class="keyword">and</span> <span class="built_in">len</span>(key_columns) % iteration_size == <span class="number">4</span>:</span><br><span class="line">            <span class="comment"># Run word through S-box in the fourth iteration when using a</span></span><br><span class="line">            <span class="comment"># 256-bit key.</span></span><br><span class="line">            word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># XOR with equivalent word from previous iteration.</span></span><br><span class="line">        word = <span class="built_in">bytes</span>(i^j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(word, key_columns[-iteration_size]))</span><br><span class="line">        key_columns.append(word)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Group key words in 4x4 byte matrices.</span></span><br><span class="line">    <span class="keyword">return</span> [key_columns[<span class="number">4</span>*i : <span class="number">4</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key_columns) // <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">key, ciphertext</span>):</span><br><span class="line">    round_keys = expand_key(key) <span class="comment"># Remember to start from the last round key and work backwards through them when decrypting</span></span><br><span class="line">    <span class="comment"># Convert ciphertext to state matrix</span></span><br><span class="line">    Cipher_matrix = bytes2matrix(ciphertext)</span><br><span class="line">    <span class="comment"># Initial add round key step</span></span><br><span class="line">    add_round_key(Cipher_matrix,round_keys[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N_ROUNDS - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        inv_shift_rows(Cipher_matrix)</span><br><span class="line">        inv_sub(Cipher_matrix)</span><br><span class="line">        add_round_key(Cipher_matrix,round_keys[i])</span><br><span class="line">        inv_mix_columns(Cipher_matrix)</span><br><span class="line">    <span class="comment"># Run final round (skips the InvMixColumns step)</span></span><br><span class="line">    inv_shift_rows(Cipher_matrix)</span><br><span class="line">    inv_sub(Cipher_matrix)</span><br><span class="line">    add_round_key(Cipher_matrix,round_keys[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Convert state matrix to plaintext</span></span><br><span class="line">    plaintext = matrix2bytes(Cipher_matrix)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line">key        = <span class="string">b&#x27;\xc3,\\\xa6\xb5\x80^\x0c\xdb\x8d\xa5z*\xb6\xfe\\&#x27;</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;\xd1O\x14j\xa4+O\xb6\xa1\xc4\x08B)\x8f\x12\xdd&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(decrypt(key, ciphertext))</span><br></pre></td></tr></table></figure>



<h3 id="ECB"><a href="#ECB" class="headerlink" title="ECB"></a>ECB</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">&quot;http://aes.cryptohack.org/ecb_oracle/encrypt/&quot;</span></span><br><span class="line">pad = <span class="string">&quot;&quot;</span></span><br><span class="line">flag_len = <span class="number">21</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0x63</span>,<span class="number">0x72</span>,<span class="number">0x79</span>,<span class="number">0x70</span>,<span class="number">0x74</span>,<span class="number">0x6f</span>,<span class="number">0x7b</span>,<span class="number">0x70</span>,<span class="number">0x33</span>,<span class="number">0x6e</span>,<span class="number">0x36</span>,<span class="number">0x75</span>,<span class="number">0x31</span>,<span class="number">0x6e</span>,<span class="number">0x35</span>]</span><br><span class="line"><span class="comment"># for j in range(0,15):</span></span><br><span class="line"><span class="comment">#     pad1 = &quot;00&quot;*(16-j-1)</span></span><br><span class="line"><span class="comment">#     cp = requests.get(url+pad1)</span></span><br><span class="line"><span class="comment">#     cpj = cp.json()</span></span><br><span class="line"><span class="comment">#     testing = (cpj[&quot;ciphertext&quot;])[0:32]</span></span><br><span class="line"><span class="comment">#     print(testing)</span></span><br><span class="line"><span class="comment">#     for i in range(32,128):</span></span><br><span class="line"><span class="comment">#         pad2 = &quot;00&quot;*(16-j-1)</span></span><br><span class="line"><span class="comment">#         for k in range(j):</span></span><br><span class="line"><span class="comment">#             pad2+= hex(flag[k])[2:]</span></span><br><span class="line"><span class="comment">#         pad2+=hex(i)[2:]</span></span><br><span class="line"><span class="comment">#         print(pad2)</span></span><br><span class="line"><span class="comment">#         now = requests.get(url+pad2)</span></span><br><span class="line"><span class="comment">#         if((now.json()[&quot;ciphertext&quot;])[0:32]==testing):</span></span><br><span class="line"><span class="comment">#             print(&quot;found &quot;, chr(i))</span></span><br><span class="line"><span class="comment">#             flag.append(i)</span></span><br><span class="line"><span class="comment">#             print(bytearray(flag).decode())</span></span><br><span class="line"><span class="comment">#             print(flag)</span></span><br><span class="line"><span class="comment">#             break</span></span><br><span class="line"></span><br><span class="line">flag2 = []</span><br><span class="line"><span class="comment"># for i in range(0,15):</span></span><br><span class="line"><span class="comment">#     pad1 = &quot;00&quot;*(7+i)</span></span><br><span class="line"><span class="comment">#     cp = requests.get(url+pad1)</span></span><br><span class="line"><span class="comment">#     respon = (cp.json()[&quot;ciphertext&quot;])</span></span><br><span class="line"><span class="comment">#     testing = respon[-32:]</span></span><br><span class="line"><span class="comment">#     print(&quot;now &quot; ,respon,testing)</span></span><br><span class="line"><span class="comment">#     for j in range(126,32,-1):</span></span><br><span class="line"><span class="comment">#         pad2 = [j]</span></span><br><span class="line"><span class="comment">#         for k in range(i):</span></span><br><span class="line"><span class="comment">#             pad2.append(flag2[k])</span></span><br><span class="line"><span class="comment">#         pad2 = bytearray((pad2))</span></span><br><span class="line"><span class="comment">#         pad2 = pad(pad2,16).hex()</span></span><br><span class="line"><span class="comment">#         print(pad2)</span></span><br><span class="line"><span class="comment">#         now = requests.get(url+(pad2))</span></span><br><span class="line"><span class="comment">#         if((now.json()[&quot;ciphertext&quot;])[0:32]==testing):</span></span><br><span class="line"><span class="comment">#             print(&quot;found &quot;, chr(i))</span></span><br><span class="line"><span class="comment">#             flag2.append(i)</span></span><br><span class="line"><span class="comment">#             print(bytearray(flag2).decode())</span></span><br><span class="line"><span class="comment">#             print(flag)</span></span><br><span class="line"><span class="comment">#             break</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>,<span class="number">32</span>):</span><br><span class="line">    pad1 = <span class="string">&quot;00&quot;</span>*(<span class="number">16</span>-j+<span class="number">16</span>-<span class="number">1</span>)</span><br><span class="line">    cp = requests.get(url+pad1)</span><br><span class="line">    cpj = cp.json()</span><br><span class="line">    <span class="built_in">print</span>(pad1)</span><br><span class="line">    testing = (cpj[<span class="string">&quot;ciphertext&quot;</span>])[<span class="number">32</span>:<span class="number">64</span>]</span><br><span class="line">    <span class="built_in">print</span>(testing)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">126</span>,<span class="number">32</span>,-<span class="number">1</span>):</span><br><span class="line">        pad2 = <span class="string">&quot;00&quot;</span>*(<span class="number">16</span>-j+<span class="number">16</span>-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(j):</span><br><span class="line">            pad2+= <span class="built_in">hex</span>(flag[k])[<span class="number">2</span>:]</span><br><span class="line">        pad2+=<span class="built_in">hex</span>(i)[<span class="number">2</span>:]</span><br><span class="line">        <span class="built_in">print</span>(pad2)</span><br><span class="line">        now = requests.get(url+pad2)</span><br><span class="line">        <span class="keyword">if</span>((now.json()[<span class="string">&quot;ciphertext&quot;</span>])[<span class="number">32</span>:<span class="number">64</span>]==testing):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;found &quot;</span>, <span class="built_in">chr</span>(i))</span><br><span class="line">            flag.append(i)</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">bytearray</span>(flag).decode())</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>crypto{p3n6u1n5_h473_3cb}</p>
</blockquote>
<h3 id="Passwords-as-Keys"><a href="#Passwords-as-Keys" class="headerlink" title="Passwords as Keys"></a>Passwords as Keys</h3><p>爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">result = requests.get(<span class="string">&#x27;https://aes.cryptohack.org/passwords_as_keys/encrypt_flag&#x27;</span>)</span><br><span class="line">ciphertext_hex = result.json()[<span class="string">&quot;ciphertext&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;words&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> f:</span><br><span class="line">        word = word.strip()</span><br><span class="line">        attempted_key = hashlib.md5(word.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">        ciphertext = <span class="built_in">bytes</span>.fromhex(ciphertext_hex)</span><br><span class="line">        key = <span class="built_in">bytes</span>.fromhex(attempted_key)</span><br><span class="line">        cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            decrypted = cipher.decrypt(ciphertext)</span><br><span class="line">            result = binascii.unhexlify(decrypted.<span class="built_in">hex</span>())</span><br><span class="line">            <span class="keyword">if</span> result.startswith(<span class="string">&#x27;crypto&#123;&#x27;</span>.encode()):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;key is %s&quot;</span> % word)</span><br><span class="line">                <span class="built_in">print</span>(result.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">                sys.exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

<h3 id="CBC"><a href="#CBC" class="headerlink" title="CBC"></a>CBC</h3><p>分别解密XOR IV </p>
<blockquote>
<p>crypto{3cb_5uck5_4v01d_17_!!!!!}</p>
</blockquote>
<h3 id="Filpping-cookies"><a href="#Filpping-cookies" class="headerlink" title="Filpping cookies"></a>Filpping cookies</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;admin=False;expi&quot;</span> ^  <span class="string">&quot;admin=True;;expi&quot;</span> ^ IV</span><br></pre></td></tr></table></figure>



<blockquote>
<p>crypto{4u7h3n71c4710n_15_3553n714l}</p>
</blockquote>
<h3 id="Lazy-CBC"><a href="#Lazy-CBC" class="headerlink" title="Lazy CBC"></a>Lazy CBC</h3><p>iv &#x3D; key</p>
<p>关键在于获取IV </p>
<p><strong>CBC-IV-Detection</strong><br>$$<br>P_1 &#x3D; D(C_1) \bigoplus IV\<br>P_2 &#x3D; D(C_2)\bigoplus C_1\<br>P_3 &#x3D; D(C_3)\bigoplus C_2<br>\<br>C2 &#x3D; “&#x2F;x00”*16\<br>C1 &#x3D; C3 \<br>IV &#x3D; D(C_3) \bigoplus P_1<br>$$</p>
<blockquote>
<p>crypto{50m3_p30pl3_d0n7_7h1nk_IV_15_1mp0r74n7_?}</p>
</blockquote>
<h3 id="Symmetry"><a href="#Symmetry" class="headerlink" title="Symmetry"></a>Symmetry</h3><p>OFB模式,加密的是IV ,异或的是PlainText , 只要得到IV加密的值 再异或密文就得到flag了</p>
<blockquote>
<p>crypto{0fb_15_5ymm37r1c4l_!!!11!}</p>
</blockquote>
<h3 id="Bean-Counter"><a href="#Bean-Counter" class="headerlink" title="Bean Counter"></a>Bean Counter</h3><p>step_up为0 ,密钥流都是一样的,直接套出xor KEY</p>
<p><img src="https://i.loli.net/2021/03/31/6a1rhIMZwkpgvWL.png" alt="2"></p>
<h3 id="CTRIME"><a href="#CTRIME" class="headerlink" title="CTRIME"></a>CTRIME</h3><p>zlib算法 运用了 行程编码 重复的两串 会经过压缩 因此可以通过prefix <code>crypto&#123;</code> 得到基准密文长度, 逐步爆破,某些地方可能需要猜测一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://aes.cryptohack.org/ctrime/encrypt/&quot;</span></span><br><span class="line">flag = <span class="string">&quot;crypto&#123;CRIME_&quot;</span></span><br><span class="line">check_len = <span class="number">70</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getlen</span>(<span class="params">payload</span>):</span><br><span class="line">    payload = <span class="built_in">bytes</span>(payload.encode())</span><br><span class="line">    p = requests.get(url + payload.<span class="built_in">hex</span>())</span><br><span class="line">    response = p.json()</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">len</span>(response[<span class="string">&quot;ciphertext&quot;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    lentmp = []</span><br><span class="line">    pflag = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        payload = flag + <span class="built_in">chr</span>(j)</span><br><span class="line">        rlen = getlen(payload)</span><br><span class="line">        lentmp.append(rlen)</span><br><span class="line">        <span class="comment">#print(i,chr(j),rlen)</span></span><br><span class="line">        <span class="keyword">if</span>(rlen == check_len):</span><br><span class="line">            flag = payload</span><br><span class="line">            pflag = <span class="number">0</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] Success flag &quot;</span> + flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span>(pflag):</span><br><span class="line">        guess = lentmp.index(<span class="built_in">min</span>(lentmp))</span><br><span class="line">        flag += <span class="built_in">chr</span>(guess+<span class="number">32</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Success &quot;</span> + flag)</span><br><span class="line">       	</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<img src="https://i.loli.net/2021/04/01/SYOyMCVwiks5K6o.png" alt="image-20210401224634753" style="zoom:67%;" />

<blockquote>
<p>crypto{CRIME_571ll_p4y5}</p>
</blockquote>
<h3 id="Stream-of-Consciousness"><a href="#Stream-of-Consciousness" class="headerlink" title="Stream of Consciousness"></a>Stream of Consciousness</h3><p>Just guessing</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">k = <span class="string">&quot;e27a6fff07e7772ee2ce35eac4835b1acbd0f2ca4b8701dc3935158b2cdd5b505cb021913fe7f98ccd617ebfe41c03e55affab6f785a33484585b1b0ebbb3081f2c8475d4370958019fc465c87820e365c161ee3aa3a1791d439194935a3800d032a8486&quot;</span></span><br><span class="line">z = <span class="string">b&quot;Dolly will think that I\&#x27;m leaving&quot;</span></span><br><span class="line">k1 = <span class="built_in">bytes</span>.fromhex(k)</span><br><span class="line">c = [<span class="string">&#x27;e87a2fb337e06c2baec57abec58415058484dec453cb31db357b1dce39ce5e521bf825c36cf1ee91c26c39bfe54f0ef140&#x27;</span>, <span class="string">&#x27;f17d62e75ea6202be1d635f1caca411982cafdd81fd3209a20350d8628c5124d5ef52dd428a2ee8c83683bf7e20041e955e9fd6b7a527c495ec4a4fefbf3209df6da5c4e4f3ebdc218ec1908cf900d21191802a0a73252d8d3771e4837ed9e19052782c63bc7dd161c4310c94436e16eb652d2b9fafda13dedc36f050d7fd7890d45d877683a69f2e08c131995c07adeea2fdeeeb75adbdee70b7794d91eda&#x27;</span>, <span class="string">&#x27;ef3570fb1fab6c67e2cd66fb8c8f431499ddeec356c92fdb357b1dce23c4461e5cf5349124ebf7c3c1643dbcbf&#x27;</span>, <span class="string">&#x27;c5677ae30aa87b2cbddb20a9ded9011cb4d6a9de0a9417ca614a1fda7a9f5e43&#x27;</span>, <span class="string">&#x27;ef3570fb1fab6c6baeeb32f2c0ca591e98c1bace49c23a82207d10802a8b5b581bf8259128edff90cd222af7f2000ce114f9ea6d7d10&#x27;</span>, <span class="string">&#x27;e76623fa18e74967e6c371becd844c519ccde9c31fd327db36705987238b46565eb032d82beaeec2834c7eb4f00146f015&#x27;</span>, <span class="string">&#x27;f17d7ab31aa82033e6c76cbecb85151e8584eaca56c93c923a72598f23cf125c4ef92cd525ecfdc3c26932f7e50704a440f2e66b29&#x27;</span>, <span class="string">&#x27;ee7a74b30eb56f32ea8274f0c8ca5d109bd4e38b57c26f9738351b8b6ddc5a5b55b028d46ce5ff97d02533aeb1010ef051ba&#x27;</span>, <span class="string">&#x27;f27d71f61be76228f7d135ecd9845b1885c3b68b4fcb29823d7b1ece2cdf125654e233d43faebab0c67727b8eb0700a5&#x27;</span>, <span class="string">&#x27;e46077b337e7772ee2ce35edc485425183cdf785&#x27;</span>, <span class="string">&#x27;ef6123f01fa92733aec070bed885471fcbcbefdf13872a8e2035109a6dc853501bf2259125e5f48cd1603af9&#x27;</span>, <span class="string">&#x27;f17d62e75ea62029efd161e78c99581487c8badf57ce3bdb24741080398b5a5f5fbe&#x27;</span>, <span class="string">&#x27;f17a76ff1ae74967e6c363fb8c88501d82c1ecce5b873c93317b599a25ca461e72b023de39eefec3d1603fb4f94f12f157f3ab6a734e67545ec4aaf6bfbb209efec2414e5239b3ce4b&#x27;</span>, <span class="string">&#x27;e96071ac5e90683eaecd60ec93&#x27;</span>, <span class="string">&#x27;e77b67b337e7732fefce79bec58d5b1e99c1bac24b89&#x27;</span>, <span class="string">&#x27;f27d66e01be76828fcd170ed80ca411982d7bac85ed53a9235721cce608b5a514cb0099120edfb97cb607ebae81c04e852bbe260364a7b555ec4a6f1eda13c92f0cb08020624b4c50dae474d8790172819120eb0f37f558dce39240123eb961300648dcd398e8f570142559d583ba477fe5adbbfe0b3c6&#x27;</span>, <span class="string">&#x27;e26766e00dea6d26e5cb7bf98c8b5b15cbe9f3c753ce269e266c&#x27;</span>, <span class="string">&#x27;ef326eb30ba96826fed26cb28ca315158ed7ffd949c268922039599a25ce12585ae52cc56bf1ba8eca6b3bfbb10d14f014d2ac63364b7d544c94b5e9bfb2399fb7da404a0623bdcd11a51540c29d0b64541f49&#x27;</span>, <span class="string">&#x27;f27d66b30aa27235e7c079fb8c9e5d1885c3bac24c873c933561599a25ce124e5ae334912fe3f4c4d7253cb2b11b0ef65abbe47b621e71450d8db1e3bfa13a9ce3dd06&#x27;</span>, <span class="string">&#x27;f67071fb1fb77367e6c735f6cd99151c82d7e9ce5b873c9331350d9c2cc25c1e5afe249125f1ba81c26635f7f31641ea5beca52e415f7d480d89aae2faf33d86fac744464724b5cf1aa8&#x27;</span>, <span class="string">&#x27;ea7a75f652e77035e1c074fcc0930a51bfccffd21fc327957361598523c4451e53ff379128f0ff82d17c7ebee54f08f718bbe361611e7b49408da9f9fea73c9df08006010624b4c554c8434dc9841e64581403e3ab375e94de6b084f7e&#x27;</span>, <span class="string">&#x27;e27a6fff07e7772ee2ce35eac4835b1acbd0f2ca4b8701dc3935158b2cdd5b505cb021913fe7f98ccd617ebfe41c03e55affab6f785a33484585b1b0ebbb3081f2c8475d4370958019fc465c87820e365c161ee3aa3a1791d439194935a3800d032a8486&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> ind,i <span class="keyword">in</span> <span class="built_in">enumerate</span>(a):</span><br><span class="line">        result.append(i^b[ind%<span class="built_in">len</span>(b)])</span><br><span class="line">    <span class="keyword">return</span>(<span class="built_in">bytearray</span>(result))</span><br><span class="line"></span><br><span class="line">key = xor(k1,z)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    test = <span class="built_in">bytes</span>.fromhex(i)</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="built_in">print</span>(xor(test,key),end=<span class="string">&quot;\n\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>crypto{k3y57r34m_r3u53_15_f474l}</p>
</blockquote>
<h1 id="Part1"><a href="#Part1" class="headerlink" title="Part1"></a>Part1</h1><h3 id="Legendre-Symbol"><a href="#Legendre-Symbol" class="headerlink" title="Legendre Symbol"></a>Legendre Symbol</h3><p><code>p = 3 mod 4</code>,</p>
<p>Tonelli-Shanks算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139</span></span><br><span class="line"></span><br><span class="line">ints = [<span class="number">25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803</span>, <span class="number">45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555</span>, <span class="number">17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325</span>, <span class="number">14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863</span>, <span class="number">4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318</span>, <span class="number">85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771</span>, <span class="number">50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987</span>, <span class="number">96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871</span>, <span class="number">4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721</span>, <span class="number">18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ints:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">pow</span>(i,(p-<span class="number">1</span>)//<span class="number">2</span>,p)==<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">pow</span>(i,(p+<span class="number">1</span>)//<span class="number">4</span>,p))</span><br></pre></td></tr></table></figure>

<h3 id="Monoprime"><a href="#Monoprime" class="headerlink" title="Monoprime"></a>Monoprime</h3><p>Why is everyone so obsessed with multiplying two primes for RSA. Why not just use one?</p>
<p>直接求d</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">171731371218065444125482536302245915415603318380280392385291836472299752747934607246477508507827284075763910264995326010251268493630501989810855418416643352631102434317900028697993224868629935657273062472544675693365930943308086634291936846505861203914449338007760990051788980485462592823446469606824421932591</span>                                                                  e = 65537ct = <span class="number">161367550346730604451454756189028938964941280347662098798775466019463375610700074840105776873791605070092554650190486030367121011578171525759600774739890458414593857709994072516290998135846956596662071379067305011746842247628316996977338024343628757374524136260758515864509435302781735938531030576289086798942</span>  <span class="keyword">import</span> libnumimport gmpy2m = <span class="built_in">pow</span>(ct,<span class="built_in">int</span>(gmpy2.invert(e,n-<span class="number">1</span>)),n)<span class="built_in">print</span>(gmpy2.is_prime(n))<span class="built_in">print</span>(libnum.n2s(m))</span><br></pre></td></tr></table></figure>

<h3 id="Square-Eyes"><a href="#Square-Eyes" class="headerlink" title="Square Eyes"></a>Square Eyes</h3><p>对N开方,计算phi和d</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s, s2n</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">N = <span class="number">535860808044009550029177135708168016201451343147313565371014459027743491739422885443084705720731409713775527993719682583669164873806842043288439828071789970694759080842162253955259590552283047728782812946845160334801782088068154453021936721710269050985805054692096738777321796153384024897615594493453068138341203673749514094546000253631902991617197847584519694152122765406982133526594928685232381934742152195861380221224370858128736975959176861651044370378539093990198336298572944512738570839396588590096813217791191895941380464803377602779240663133834952329316862399581950590588006371221334128215409197603236942597674756728212232134056562716399155080108881105952768189193728827484667349378091100068224404684701674782399200373192433062767622841264055426035349769018117299620554803902490432339600566432246795818167460916180647394169157647245603555692735630862148715428791242764799469896924753470539857080767170052783918273180304835318388177089674231640910337743789750979216202573226794240332797892868276309400253925932223895530714169648116569013581643192341931800785254715083294526325980247219218364118877864892068185905587410977152737936310734712276956663192182487672474651103240004173381041237906849437490609652395748868434296753449</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">222502885974182429500948389840563415291534726891354573907329512556439632810921927905220486727807436668035929302442754225952786602492250448020341217733646472982286222338860566076161977786095675944552232391481278782019346283900959677167026636830252067048759720251671811058647569724495547940966885025629807079171218371644528053562232396674283745310132242492367274184667845174514466834132589971388067076980563188513333661165819462428837210575342101036356974189393390097403614434491507672459254969638032776897417674577487775755539964915035731988499983726435005007850876000232292458554577437739427313453671492956668188219600633325930981748162455965093222648173134777571527681591366164711307355510889316052064146089646772869610726671696699221157985834325663661400034831442431209123478778078255846830522226390964119818784903330200488705212765569163495571851459355520398928214206285080883954881888668509262455490889283862560453598662919522224935145694435885396500780651530829377030371611921181207362217397805303962112100190783763061909945889717878397740711340114311597934724670601992737526668932871436226135393872881664511222789565256059138002651403875484920711316522536260604255269532161594824301047729082877262812899724246757871448545439896</span></span><br><span class="line">p = gmpy2.iroot(N, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">phi =  N-p</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h3 id="ManyPrime"><a href="#ManyPrime" class="headerlink" title="ManyPrime"></a>ManyPrime</h3><p>Using one prime factor was definitely a bad idea so I’ll try using over 30 instead.</p>
<p>sagemath分解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s, s2n</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">580642391898843192929563856870897799650883152718761762932292482252152591279871421569162037190419036435041797739880389529593674485555792234900969402019055601781662044515999210032698275981631376651117318677368742867687180140048715627160641771118040372573575479330830092989800730105573700557717146251860588802509310534792310748898504394966263819959963273509119791037525504422606634640173277598774814099540555569257179715908642917355365791447508751401889724095964924513196281345665480688029639999472649549163147599540142367575413885729653166517595719991872223011969856259344396899748662101941230745601719730556631637</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">ct = <span class="number">320721490534624434149993723527322977960556510750628354856260732098109692581338409999983376131354918370047625150454728718467998870322344980985635149656977787964380651868131740312053755501594999166365821315043312308622388016666802478485476059625888033017198083472976011719998333985531756978678758897472845358167730221506573817798467100023754709109274265835201757369829744113233607359526441007577850111228850004361838028842815813724076511058179239339760639518034583306154826603816927757236549096339501503316601078891287408682099750164720032975016814187899399273719181407940397071512493967454225665490162619270814464</span></span><br><span class="line"></span><br><span class="line">pr =[ <span class="number">9282105380008121879</span> , <span class="number">9303850685953812323</span> , <span class="number">9389357739583927789</span> , <span class="number">10336650220878499841</span> , <span class="number">10638241655447339831</span> , <span class="number">11282698189561966721</span> , <span class="number">11328768673634243077</span> , <span class="number">11403460639036243901</span> , <span class="number">11473665579512371723</span> , <span class="number">11492065299277279799</span> , <span class="number">11530534813954192171</span> , <span class="number">11665347949879312361</span> , <span class="number">12132158321859677597</span> , <span class="number">12834461276877415051</span> , <span class="number">12955403765595949597</span> , <span class="number">12973972336777979701</span> , <span class="number">13099895578757581201</span> , <span class="number">13572286589428162097</span> , <span class="number">14100640260554622013</span> , <span class="number">14178869592193599187</span> , <span class="number">14278240802299816541</span> , <span class="number">14523070016044624039</span> , <span class="number">14963354250199553339</span> , <span class="number">15364597561881860737</span> , <span class="number">15669758663523555763</span> , <span class="number">15824122791679574573</span> , <span class="number">15998365463074268941</span> , <span class="number">16656402470578844539</span> , <span class="number">16898740504023346457</span> , <span class="number">17138336856793050757</span> , <span class="number">17174065872156629921</span> , <span class="number">17281246625998849649</span></span><br><span class="line">]</span><br><span class="line">phi = n</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> pr:</span><br><span class="line">    phi = phi - phi//i</span><br><span class="line">d = gmpy2.invert(e,phi )</span><br><span class="line">m = <span class="built_in">pow</span>(ct, d, n)</span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Everything-is-Big"><a href="#Everything-is-Big" class="headerlink" title="Everything is Big"></a>Everything is Big</h3><p>e很大,使用wiener attack</p>
<h3 id="Everything-is-Still-Big"><a href="#Everything-is-Still-Big" class="headerlink" title="Everything is Still Big"></a>Everything is Still Big</h3><p>e任然很大,但不能使用wiener attack</p>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/mimoo/RSA-and-LLL-attacks/master/boneh_durfee.sage">boneh_durfee.sage</a></p>
<h3 id="Endless-Emails"><a href="#Endless-Emails" class="headerlink" title="Endless Emails"></a>Endless Emails</h3><p>低指数共模,CRT 开3方, 全组合排列一下</p>
<h1 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h1><h3 id="Infinite-Descent"><a href="#Infinite-Descent" class="headerlink" title="Infinite Descent"></a>Infinite Descent</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getPrimes</span>(<span class="params">bitsize</span>):</span><br><span class="line">    r = random.getrandbits(bitsize)</span><br><span class="line">    p, q = r, r</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(p):</span><br><span class="line">        p += random.getrandbits(bitsize//<span class="number">4</span>) <span class="comment">#512</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(q):</span><br><span class="line">        q += random.getrandbits(bitsize//<span class="number">8</span>) <span class="comment">#256</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>直接yafu &#x2F;&#x2F;fermat分解</p>
<blockquote>
<p>crypto{f3rm47_w45_4_g3n1u5}</p>
</blockquote>
<h3 id="Ron-was-Wrong-Whit-is-Right"><a href="#Ron-was-Wrong-Whit-is-Right" class="headerlink" title="Ron was Wrong, Whit is Right"></a>Ron was Wrong, Whit is Right</h3><p>寻找公因子</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">pf = os.listdir(<span class="string">&quot;keys_and_messages&quot;</span>)</span><br><span class="line">keys = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">51</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;keys_and_messages/&quot;</span>+ <span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>.pem&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        keys.append((RSA.import_key(f.read())))</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">for</span> ind,i <span class="keyword">in</span> <span class="built_in">enumerate</span>(keys):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> (keys):  </span><br><span class="line">        n1 = i.n</span><br><span class="line">        n2 = j.n</span><br><span class="line">        <span class="keyword">if</span>(gcd(n1,n2)==<span class="number">1</span> <span class="keyword">or</span> n1 == n2):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:    </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;find&quot;</span>,ind)</span><br><span class="line">            p = gcd(n1,n2)</span><br><span class="line">            q = n1//p</span><br><span class="line">            phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            d = invert(i.e,phi)</span><br><span class="line">            pk1 = RSA.construct((i.n, i.e,<span class="built_in">int</span>(d), p, q))</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;keys_and_messages/&quot;</span>+ <span class="built_in">str</span>(ind+<span class="number">1</span>)+<span class="string">&quot;.ciphertext&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="built_in">print</span>(PKCS1_OAEP.new(pk1).decrypt(<span class="built_in">bytes</span>.fromhex(f.read())))</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>crypto{3ucl1d_w0uld_b3_pr0ud} </p>
</blockquote>
<h3 id="Fast-Primes"><a href="#Fast-Primes" class="headerlink" title="Fast Primes"></a>Fast Primes</h3><p>直接factordb &#x2F; ROCA</p>
<h4 id="Return-of-Coppersmith’s-attack"><a href="#Return-of-Coppersmith’s-attack" class="headerlink" title="Return of Coppersmith’s attack"></a>Return of Coppersmith’s attack</h4><p><a target="_blank" rel="noopener" href="https://gist.github.com/zademn/6becc979f65230f70c03e82e4873e3ec">https://gist.github.com/zademn/6becc979f65230f70c03e82e4873e3ec</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u011718707/article/details/108269255">https://blog.csdn.net/u011718707/article/details/108269255</a></p>
<h3 id="related-message-attack"><a href="#related-message-attack" class="headerlink" title="related message attack"></a>related message attack</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">related_message_attack</span>(<span class="params">c1, c2, diff, e, n</span>):</span><br><span class="line">    PRx.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = x^e - c1</span><br><span class="line">    g2 = (x+diff)^e - c2</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">n =<span class="number">138003183601599264552976011112138526855440035987349769252889444634862901688437808761476829620137061537107954566317776193307717830272178447711206566603125160974435033021408152381140059150973297993562127289855294221304307167869109156077840599212284667944463229599800290481673118120033457570311553532018244618339</span></span><br><span class="line">c2 =<span class="number">131382043397384601338797577458171435623117057573634256682419966216673275306767841107430885600202437876426215473899150238248810751859672943066085319992623747688498255421453135216770904684560159351521387135877632920518957443551263143485585596920903626532209556574755079473247497801692321226527752283286693224029</span></span><br><span class="line">c1 = <span class="number">48898408608225850033408245146151373640428045737101898704512067139522243804480526840706245015597384610320051535839961715976934823752904879106719487554356812439412488356067951798913706049265800157477652507117009217401058194943459736345450365946143280358913715188237677343957829768599235887785604449898043759195</span></span><br><span class="line"></span><br><span class="line">e=<span class="number">1313</span></span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">b = -<span class="number">1</span></span><br><span class="line">m1 = related_message_attack(c1,c2, b,e,n)</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(<span class="string">&quot;%x&quot;</span> % <span class="built_in">int</span>(<span class="number">2</span>*m1)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#pow(m//2,e,n)</span></span><br><span class="line"><span class="comment">#pow(m,e,n)</span></span><br></pre></td></tr></table></figure>

<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h3 id="No-Way-JOSE"><a href="#No-Way-JOSE" class="headerlink" title="No Way JOSE"></a>No Way JOSE</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt		</span><br><span class="line">jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;123&quot;</span>, <span class="string">&#x27;admin&#x27;</span>: <span class="literal">True</span>&#125;,<span class="literal">None</span>, algorithm=<span class="string">&#x27;none&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>crypto{The_Cryptographic_Doom_Principle}</p>
</blockquote>
<h3 id="JWT-secret"><a href="#JWT-secret" class="headerlink" title="JWT secret"></a>JWT secret</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SECRET_KEY = <span class="string">&quot;secret&quot;</span></span><br><span class="line">jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;admin&quot;</span>, <span class="string">&#x27;admin&#x27;</span>: <span class="literal">True</span>&#125;, SECRET_KEY, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>crypto{jwt_secret_keys_must_be_protected}</p>
</blockquote>
<h3 id="RSA-or-HMAC"><a href="#RSA-or-HMAC" class="headerlink" title="RSA  or HMAC"></a>RSA  or HMAC</h3><p>Patch  <code>\Python\Python36\lib\site-packages\jwt\algorithms.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">prepare_key</span>(<span class="params">self, key</span>):</span><br><span class="line">    key = force_bytes(key)</span><br><span class="line">    invalid_strings = [</span><br><span class="line">        <span class="string">b&quot;-----BEGIN PUBLIC KEY-----&quot;</span>,</span><br><span class="line">        <span class="string">b&quot;-----BEGIN CERTIFICATE-----&quot;</span>,</span><br><span class="line">        <span class="string">b&quot;-----BEGIN RSA PUBLIC KEY-----&quot;</span>,</span><br><span class="line">        <span class="string">b&quot;ssh-rsa&quot;</span>,</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>(string_value <span class="keyword">in</span> key <span class="keyword">for</span> string_value <span class="keyword">in</span> invalid_strings):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        <span class="comment"># raise InvalidKeyError(</span></span><br><span class="line">        <span class="comment">#     &quot;The specified key is an asymmetric key or x509 certificate and&quot;</span></span><br><span class="line">        <span class="comment">#     &quot; should not be used as an HMAC secret.&quot;</span></span><br><span class="line">        <span class="comment"># )</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> key</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line">pk = <span class="string">&quot;-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsXRBeaADq9e5tKU5UzAc\n/Ty4e/kUmIMJJXeIYBy8qs9mfB2OISHIRLZj7jqxuhqa+bi6VNhIEGUdvOBQYGnZ\nHoTGKsMDTjAiWVC7AQUVirLt1oZDNat+7hs5lnkscpx4B5tSEFR0C5uC9cDoolrZ\nP366Bykb1nYfp7B8JIZS1iYgT6WWYO+aZ3/z95vJku1XiYSCbwGxntkP0w0bOBth\nKBfUIFHHa53ba6l8GT6ATAYA0hak8FTz7on+GQme0GYUV1DpnZ4Rx8x8/jWK49w/\n70/OxCKCYzXhYt/5tB2SweRUOsVSHYtpLa6ad0J4xydkmJaGshvYrHT5+Uk0zFHK\npwIDAQAB\n-----END PUBLIC KEY-----\n&quot;</span></span><br><span class="line">encoded = jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;admin&#x27;</span>: <span class="literal">True</span>&#125;, pk, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(encoded)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>crypto{Doom_Principle_Strikes_Again}</p>
</blockquote>
<h3 id="JSON-in-JSON"><a href="#JSON-in-JSON" class="headerlink" title="JSON in JSON"></a>JSON in JSON</h3><p>payload</p>
<p><code>123&quot;, &quot;admin&quot;:&quot;True</code></p>
<blockquote>
<p>crypto{<a target="_blank" rel="noopener" href="https://owasp.org/www-community/Injection_Theory%7D">https://owasp.org/www-community/Injection_Theory}</a></p>
</blockquote>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h3 id="No-Leaks"><a href="#No-Leaks" class="headerlink" title="No Leaks"></a>No Leaks</h3><p>排除法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> telnetlib</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">HOST = <span class="string">&quot;socket.cryptohack.org&quot;</span></span><br><span class="line">PORT = <span class="number">13370</span></span><br><span class="line"><span class="comment">#flag = np.array([[1]*128]*20)</span></span><br><span class="line">flag = np. loadtxt(<span class="string">&quot;./1.txt&quot;</span>)</span><br><span class="line">red = [<span class="number">0</span>]*<span class="number">20</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span>(flag[i][j]==<span class="number">1</span>):</span><br><span class="line">            red[i]+=<span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readline</span>():</span><br><span class="line">    <span class="keyword">return</span> tn.read_until(<span class="string">b&quot;\n&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_recv</span>():</span><br><span class="line">    line = readline()</span><br><span class="line">    <span class="keyword">return</span> json.loads(line.decode())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">json_send</span>(<span class="params">hsh</span>):</span><br><span class="line">    request = json.dumps(hsh).encode()</span><br><span class="line">    tn.write(request)</span><br><span class="line"></span><br><span class="line">request = &#123;</span><br><span class="line">    <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;request&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">50</span>):</span><br><span class="line">    time.sleep(<span class="number">0.3</span>)</span><br><span class="line">    tn = telnetlib.Telnet(HOST, PORT)</span><br><span class="line">    readline()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        json_send(request)</span><br><span class="line">        response = json_recv()</span><br><span class="line">        <span class="keyword">if</span>(response.__contains__(<span class="string">&quot;ciphertext&quot;</span>)):</span><br><span class="line">            c = (response[<span class="string">&quot;ciphertext&quot;</span>])</span><br><span class="line">            cb = base64.b64decode(c)</span><br><span class="line">            <span class="keyword">for</span> ind,b <span class="keyword">in</span> <span class="built_in">enumerate</span>(cb):</span><br><span class="line">                <span class="keyword">if</span>(b&lt;<span class="number">128</span>):</span><br><span class="line">                    <span class="keyword">if</span>(flag[ind][b] == <span class="number">1</span>):</span><br><span class="line">                        red[ind] -= <span class="number">1</span></span><br><span class="line">                        flag[ind][b] = <span class="number">0</span></span><br><span class="line">    tn.close()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">np.savetxt(<span class="string">&quot;./1.txt&quot;</span>,flag)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">20</span>):</span><br><span class="line">	<span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">		<span class="keyword">if</span>(flag[j][m]==<span class="number">1</span>):</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">chr</span>(m),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                            </span><br></pre></td></tr></table></figure>

<blockquote>
<p>crypto{unr4nd0m_07p}</p>
</blockquote>
<h1 id="Gernal"><a href="#Gernal" class="headerlink" title="Gernal"></a>Gernal</h1><h2 id="Transparency"><a href="#Transparency" class="headerlink" title="Transparency"></a>Transparency</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl pkey -outform der -pubin -in transparency.pem | sha256sum</span><br></pre></td></tr></table></figure>

<p><code>29ab37df0a4e4d252f0cf12ad854bede59038fdd9cd652cbc5c222edd26d77d2</code></p>
<p><a target="_blank" rel="noopener" href="https://censys.io/certificates">https://censys.io/certificates</a></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WriteUp/">WriteUp</a><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/08/29/Reverse/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%E7%AC%94%E8%AE%B0-PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" title="加密与解密笔记-PE文件格式"><img class="cover" src="https://i.loli.net/2021/08/29/ki8y5sOeEBKD49A.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">加密与解密笔记-PE文件格式</div></div></a></div><div class="next-post pull-right"><a href="/2021/08/11/Life/Midnight/" title="Midnight"><img class="cover" src="https://s2.loli.net/2024/02/20/ilROfZ6LXspkr8B.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Midnight</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2024/05/04/Zav4zFVukLJMBKI.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">devoke</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/03/Reverse/lighthouse%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" title="lighthouse 使用指南">lighthouse 使用指南</a><time datetime="2024-03-03T15:45:14.000Z" title="发表于 2024-03-03 23:45:14">2024-03-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/19/Life/ES%E5%B0%8F%E4%B8%BB%E6%9C%BA%E6%8A%98%E8%85%BE%E8%AE%B0/" title="ES小主机折腾记">ES小主机折腾记</a><time datetime="2024-02-19T03:05:01.000Z" title="发表于 2024-02-19 11:05:01">2024-02-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/03/20/WriteUp/HFCTF2022-RE/" title="HFCTF2022 RE">HFCTF2022 RE</a><time datetime="2022-03-20T12:04:53.000Z" title="发表于 2022-03-20 20:04:53">2022-03-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/03/09/WriteUp/%E7%AE%80%E7%AE%80%E5%8D%95%E5%8D%95%E5%AF%86%E7%A0%81%E9%A2%98/" title="简简单单密码题">简简单单密码题</a><time datetime="2022-03-09T12:08:44.000Z" title="发表于 2022-03-09 20:08:44">2022-03-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/02/03/Python/Python-multiprocess-learning/" title="Python multiprocess learning">Python multiprocess learning</a><time datetime="2022-02-03T06:25:30.000Z" title="发表于 2022-02-03 14:25:30">2022-02-03</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2024/02/20/h3iOcSdRqel45vD.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By devoke</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/"></script><script src="/"></script><script src="/"></script><div class="js-pjax"></div></div></body></html>