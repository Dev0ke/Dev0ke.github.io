<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>devoke's blog</title><meta name="author" content="devoke"><meta name="copyright" content="devoke"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description"><link rel="shortcut icon" href="https://s2.loli.net/2024/02/20/B6y8wIH5iltGxP9.png"><link rel="canonical" href="http://example.com/page/2/index.html"><link rel="preconnect"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/"><link rel="stylesheet" href="/" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: '/',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: ,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'devoke\'s blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-05-04 17:54:22'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2024/05/04/Zav4zFVukLJMBKI.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://s2.loli.net/2024/02/20/i5askw6xYVRKDtE.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="devoke's blog"><span class="site-name">devoke's blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">devoke's blog</h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/08/29/Reverse/%E5%8A%A0%E5%AF%86%E4%B8%8E%E8%A7%A3%E5%AF%86%E7%AC%94%E8%AE%B0-PE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/" title="åŠ å¯†ä¸è§£å¯†ç¬”è®°-PEæ–‡ä»¶æ ¼å¼">åŠ å¯†ä¸è§£å¯†ç¬”è®°-PEæ–‡ä»¶æ ¼å¼</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time datetime="2021-08-29T12:38:26.000Z" title="å‘è¡¨äº 2021-08-29 20:38:26">2021-08-29</time></span></div><div class="content">â€‹	åŸºç¡€å¤ªå·®äº†ï¼Œè¡¥ä¸€è¡¥ã€‚
PEæ–‡ä»¶è§£æåŸºæœ¬æ¦‚å¿µPEæ–‡ä»¶ï¼šPortable Executable File Formatæ ¼å¼æ–‡ä»¶æ˜¯Windowså¹³å°ä¸Šä¸»æµå¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼
æ¨¡å—ï¼šPEæ–‡ä»¶é€šè¿‡WindowsåŠ è½½å™¨è½½å…¥å†…å­˜ä¸­åï¼Œå†…å­˜ä¸­çš„ç‰ˆæœ¬ç§°ä¸ºæ¨¡å—(Module)ï¼Œå…¶èµ·å§‹åœ°å€æˆä¸ºæ¨¡å—å¥æŸ„ï¼ˆhModule) æˆ– åŸºåœ°å€ï¼ˆImageBaseï¼‰

GetModuleHandle(LPCTSTR lpModuleName)å¯ä»¥æ ¹æ®æ¨¡å—åè·å¾—å¯¹åº”çš„æ¨¡å—å¥æŸ„ï¼Œä¼ å…¥NULLå‚æ•°åˆ™è¿”å›è‡ªèº«å¥æŸ„

VAï¼šæ¯ä¸ªç¨‹åºéƒ½æœ‰è‡ªå·±çš„è™šæ‹Ÿç©ºé—´ï¼Œè¿™ä¸ªè™šæ‹Ÿç©ºé—´çš„å†…å­˜åœ°å€æˆä¸ºè™šæ‹Ÿåœ°å€ï¼ˆVirutal Addressï¼‰
RVAï¼šæ¨¡å—çš„åŸºåœ°å€å¯ä»¥æ˜¯ä»»æ„åœ°æ–¹ï¼Œå› æ­¤å¼•å…¥ç›¸å¯¹è™šæ‹Ÿåœ°å€ï¼ˆRelative Virtual Addressï¼‰æ¥è®¿é—®æ¨¡å—ä¸­çš„ä»£ç æˆ–æ•°æ®
æ–‡ä»¶åç§»åœ°å€ï¼ˆFile offsetï¼‰ï¼šä¹Ÿå«ç‰©ç†åœ°å€ï¼ˆRAW offsetï¼‰ï¼Œä»£è¡¨æŸä¸ªæ•°æ®çš„ä½ç½®è·ç¦»æ–‡ä»¶å¤´çš„çš„å­—èŠ‚æ•°
PEæ ¼å¼æ¡†æ¶ç»“æ„


MS-DOS HEADRER
æ¯”è¾ƒé‡è¦çš„å­—æ®µæ˜¯

æŒ‡å‘PEæ–‡ä»¶å¤´ï¼ˆNtHeaderï¼‰ çš„ AddressOfNewExeHeader

è¯¥PEæ–‡ ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/08/11/WriteUp/CryptoHack-Writeup/" title="CryptoHack Writeup">CryptoHack Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time datetime="2021-08-11T08:02:53.000Z" title="å‘è¡¨äº 2021-08-11 16:02:53">2021-08-11</time></span></div><div class="content">CryptoHack â€“ A fun free platform for learning cryptographyçš„ä¸€äº›é¢˜è§£ï¼Œæ¯”è¾ƒä¹…è¿œã€‚
MathSize and Basisè®¡ç®—å‘é‡çš„æ¨¡$$|v| &#x3D; \sqrt{4^2+6^2+5^2+2^2}$$
Gram SchmidtGram-Schmidtæ­£äº¤åŒ–æ–¹æ³•
1234567from sympy.matrices import Matrix,GramSchmidtimport numpy as npv = np.array([[4,1,3,-1],[2,1,-3,4],[1,0,-2,7],[6, 2, 9, -5]])v = [Matrix(col) for col in v]print(eval(str(GramSchmidt(v)[3][1])))#0.91610738



Blockbijection åŒå°„
Structure of AES1234def matrix2bytes(matrix):    return b&quot;&quot;.join(bytearray(i) for i in matrix)	 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/08/11/Life/Midnight/" title="Midnight">Midnight</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time datetime="2021-08-11T07:42:09.000Z" title="å‘è¡¨äº 2021-08-11 15:42:09">2021-08-11</time></span></div><div class="content">â€‹	 æäº†åŠå¹´çš„åšå®¢ç»ˆäºæ­èµ·æ¥äº†ï¼ˆÃ—ï¼‰ï¼Œé™¤äº†åˆ†äº«ä¹‹å¤–ï¼Œä¹Ÿè¯¥å†™å†™æ€»ç»“ä»€ä¹ˆçš„äº†ã€‚
ç§‘æ©å®ä¹ å‡‰ç»â€‹      äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œç”±äºç§‘æ©è·Ÿå­¦é™¢æœ‰ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„å…³ç³»ï¼Œäºæ˜¯ä¸ºäº†äººæƒ…ä¸–æ•…éœ€è¦æŠ“ä¸€äº›å£®ä¸å»å®ä¹ ï¼Œå—å®³è€…æœ‰æˆ‘ï¼ŒK2016ï¼Œjaçš„é˜Ÿå‹ğŸ»ï¼Œbaseä¸Šæµ·ï¼Œæœ¬ç€å¿«ä¹æš‘å‡çš„åŸåˆ™ï¼Œæƒ³ç€åˆ°æ—¶èƒ¡è¨€ä¹±è¯­ä¸€æ³¢å°±æºœäº†ï¼Œå°±çå†™äº†ä¸€ä»½ç®€å†å°±äº¤äº†ä¸Šå»ï¼ˆåæ¥è¯æ˜æˆ‘æƒ³å¤šäº†ï¼Œå³ä½¿è®¤çœŸå¯¹å¾…è¿˜æ˜¯ä¸€æ ·å‡‰äº†ï¼Œèœæ˜¯åŸç½ªï¼‰ã€‚
â€‹       æš‘å‡è¿‡åˆ°ä¸€åŠï¼Œçªç„¶æ¥åˆ°äº†txç”µè¯ï¼Œçº¦åœ¨å½“å¤©æ™šä¸Šé¢è¯•ï¼Œè¿œç¨‹çº¯è¯­éŸ³é¢è¯•ï¼Œé¢æˆ‘çš„æ˜¯ä¸¤ä¸ªæ¯”è¾ƒå‹å¥½çš„å‰è¾ˆï¼Œæ ¹æ®æçš„é—®é¢˜æ¥çœ‹ï¼Œå…¶ä¸­ä¸€ä½åº”è¯¥æ˜¯ææ¼æ´æŒ–æ˜çš„ï¼ˆé—®çš„é—®é¢˜æ¯”è¾ƒå¤šï¼‰ï¼Œå¦ä¸€ä½åå‘å¼€å‘ã€‚ä¸Šæ¥å…ˆæ˜¯ä¸€ä¸ªè‡ªæˆ‘ä»‹ç»ï¼Œç„¶åå°±å¼€å§‹æé—®äº†ã€‚
Part1å‰é¢é—®çš„æ¯”è¾ƒåŸºç¡€ï¼ŒåŸºæœ¬éƒ½æ˜¯ã€ŠåŠ å¯†ä¸è§£å¯†ã€‹é‡Œçš„å†…å®¹ã€‚æ—¶é—´è¿‡çš„æ¯”è¾ƒä¹…ï¼Œé¡ºåºä¸å½“æ—¶çš„ä¸å¤ªä¸€æ ·ï¼Œå¯èƒ½ä¼šæœ‰éƒ¨åˆ†é—æ¼ã€‚

æ–­ç‚¹ç±»å‹æœ‰å“ªäº›ï¼Ÿ
è½¯ä»¶æ–­ç‚¹ã€ç¡¬ä»¶æ–­ç‚¹ã€æ¡ä»¶æ–­ç‚¹ã€å†…å­˜æ–­ç‚¹ã€æ¶ˆæ¯æ–­ç‚¹ã€‚

è½¯ä»¶æ–­ç‚¹çš„å®ç°ï¼Ÿ
ä¿®æ”¹æ–­ç‚¹æ‰€åœ¨ä½ç½®çš„æŒ‡ä»¤ä¸º0xCCï¼Œåˆ°è¾¾æ­¤å¤„ä¾¿ä¼šè§¦å‘å¼‚å¸¸ã€‚å†…éƒ¨å®ç°å¯ä»¥å‚è€ƒ4.è½¯ä»¶æ–­ç‚¹ã€‚

å†…å­˜æ–­ç‚¹çš„å®ç°ï¼Ÿ
å†…å­˜æ–­ç‚¹çš„å®ç°æ–¹å¼æ˜¯å°†ä½ æ¬²ä¸‹æ–­åœ°å€æ‰€åœ¨çš„å†…å­˜é¡µå¢åŠ ä¸€ä¸ªåä¸ºPAGE_ ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/08/08/Reverse/Ollvm-Deobfuscation-Learning/" title="Ollvm Deobfuscation Learning">Ollvm Deobfuscation Learning</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time datetime="2021-08-08T03:49:55.000Z" title="å‘è¡¨äº 2021-08-08 11:49:55">2021-08-08</time></span></div><div class="content">ç®€ä»‹ollvmHome Â· obfuscator-llvm&#x2F;obfuscator Wiki (github.com)
Obfuscator-LLVM æ˜¯ 2010 å¹´ 6 æœˆç”± Yverdon-les-Bains çš„ç‘å£«è¥¿éƒ¨åº”ç”¨ç§‘å­¦ä¸è‰ºæœ¯å¤§å­¦ (HEIG-VD) çš„ä¿¡æ¯å®‰å…¨å°ç»„å‘èµ·çš„ä¸€ä¸ªé¡¹ç›®ã€‚
è¯¥é¡¹ç›®çš„ç›®çš„æ˜¯æä¾› LLVM ç¼–è¯‘å¥—ä»¶çš„å¼€æºåˆ†æ”¯ï¼Œèƒ½å¤Ÿé€šè¿‡ä»£ç æ··æ·†å’Œé˜²ç¯¡æ”¹æä¾›æ›´é«˜çš„è½¯ä»¶å®‰å…¨æ€§ã€‚
å®ƒåŒ…å«ä¸‰ç§æ··æ·†ä¿æŠ¤æ–¹å¼ã€‚
æ§åˆ¶æµå¹³å¦åŒ–Control Flow Flatteningâ€‹	CTFæ¯”èµ›ä¸­æ¯”è¾ƒå¸¸è§çš„æ··æ·†ä¿æŠ¤æ–¹å¼

æ··æ·†åçš„å—åˆ†ä¸º

åºè¨€Prologue
å‡½æ•°å¼€å§‹åœ°å€å¯¹åº”çš„åŸºæœ¬å—

ä¸»åˆ†å‘å™¨Main dispatcher
åºè¨€çš„åç»§ä¸ºä¸»åˆ†å‘å™¨

å­åˆ†å‘å™¨Sub dispatcher

çœŸå®å—Relevant blocks
åç»§ä¸ºé¢„å¤„ç†å™¨çš„å—ä¸ºçœŸå®å—

è¿”å›å—Retn
æ— åç»§çš„å—ä¸ºretnå—



é¢„å¤„ç†å™¨Pre dispatcher
åç»§ä¸ºä¸»åˆ†å‘å™¨çš„å—ä¸ºé¢„å¤„ç†å™¨


è™šå‡æ§åˆ¶æµBogus Control Flowå‘åŸºæœ¬å—ä¸­éšæœºæ·»åŠ åƒåœ¾æŒ‡ä»¤ï¼ŒåŒæ—¶ä¼šæ·»åŠ ä¸€äº›è·³è½¬è¯­å¥å’Œç”¨äºæ¡ä»¶è·³è½¬çš„ ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/07/26/Misc/Misc-%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" title="MISC æ‚ä¸ƒæ‚å…«">MISC æ‚ä¸ƒæ‚å…«</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time datetime="2021-07-26T07:56:46.000Z" title="å‘è¡¨äº 2021-07-26 15:56:46">2021-07-26</time></span></div><div class="content">å‰è¨€
è¡¥å……è‡ª Ga1@xy miscå·¥å…·

å›¾ç‰‡Imagejpgf5-steganography ï¼ˆF5éšå†™+passwdï¼‰
å®‰è£…

1git clone https://github.com/matthewgao/F5-steganography


ä½¿ç”¨: è¿›å…¥ F5-steganography æ–‡ä»¶å¤¹

12java Extract 1.jpg -p 123456// -påæ¥f5çš„key

outguess (å›¾ç‰‡éšå†™)
åŠ å¯†

1234outguess -k 12345 -d hidden.txt 1.jpg 2.jpg// -kåæ¥å¯†ç s// -dåæ¥è¦éšè—çš„å†…å®¹// åŠ å¯†å1.jpgä¼šè¦†ç›–2.jpg


è§£å¯†

1234outguess -k 12345 -r 2.jpg out.txt// out.txt ä¸­å†…å®¹å³ä¸ºæƒ³è¦éšè—çš„ hidden.txt ä¸­å†…å®¹// ä¹Ÿå¯ä¸éœ€è¦å¯†ç outguess -r 2.jpg out.txt

stegdetectï¼ˆæ£€æŸ¥jpgå›¾ç‰‡éšå†™æ–¹æ³•_winï¼‰12345678stegdetect.exe -tjopi -s 10.0 [stego_ ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/07/08/WriteUp/PWN-Writeup/" title="PWN Writeup">PWN Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time datetime="2021-07-08T14:37:27.000Z" title="å‘è¡¨äº 2021-07-08 22:37:27">2021-07-08</time></span></div><div class="content">PwnableStart

ä¿æŠ¤å…¨å…³,æœ‰ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨ write å’Œ read ,æ˜¾ç„¶æ˜¯é€šè¿‡æ ˆæº¢å‡ºæ¥æ‰§è¡Œæ ˆä¸Šçš„shellcode
12#define __NR_read 3#define __NR_write 4	

12345678910111213141516171819202122.text:08048060 push    esp.text:08048061 push    offset _exit.text:08048066 xor     eax, eax.text:08048068 xor     ebx, ebx.text:0804806A xor     ecx, ecx.text:0804806C xor     edx, edx.text:0804806E push    &#x27;:FTC&#x27;.text:08048073 push    &#x27; eht&#x27;.text:08048078 push    20747261h.text:0804807D push    74732073h.text:08048082 push    277465 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/07/08/Pwn/Heap-learning-note-devoke/" title="Heap learning note">Heap learning note</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time datetime="2021-07-08T14:33:41.000Z" title="å‘è¡¨äº 2021-07-08 22:33:41">2021-07-08</time></span></div><div class="content">ç›®å‰æ­£åœ¨å­¦å †ç›¸å…³çš„æ¼æ´åŠåˆ©ç”¨ï¼Œèµ„æ–™å‚è€ƒçš„æ˜¯shellphishæˆ˜é˜Ÿç¼–å†™çš„how2heap: A repository for learning various heap exploitation techniques.ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±çš„å­¦ä¹ è¿‡ç¨‹ã€‚

Ubuntu 16.04
python2

0x00  prepare123git clone https://github.com/shellphish/how2heap.gitcd how2heapmake

0x01 basicfirst_fitâ€‹	å³æ“ä½œç³»ç»Ÿå­¦è¿‡çš„é¦–æ¬¡é€‚åº”(æœ€å¿«é€‚åº”)ç®—æ³•ï¼Œå†åŠ ä¸Šbinä¸­FIFOçš„é¡ºåºï¼Œæ‰€ä»¥åœ¨ç”³è¯·å¤§å°æ¥è¿‘çš„å †çš„æ—¶å€™ï¼Œä¼šä¼˜å…ˆåˆ†é…åˆ°æœ€æ—©freeçš„chunkã€‚
calc_tcache_idxâ€‹	åœ¨Glibcçš„2.26ä¸­ æ–°å¢äº†Tcacheæœºåˆ¶ è¿™æ˜¯ptmalloc2çš„ç¼“å­˜æœºåˆ¶,cacheä¸ºæ¯ä¸ªçº¿ç¨‹éƒ½é¢„ç•™äº†è¿™æ ·ä¸€ä¸ªç‰¹æ®Šçš„binsï¼Œ binçš„æ•°é‡æ˜¯64ä¸ª æ¯ä¸ªbinä¸­æœ€å¤šç¼“å­˜7ä¸ªchunkã€‚åœ¨64ä½ç³»ç»Ÿä¸Šä»¥0x10çš„å­—èŠ‚é€’å¢ï¼Œä»24é€’å¢åˆ°1032å­—èŠ‚ã€‚32ä½ç³»ç»Ÿä¸Šåˆ™ä»12åˆ°512å­—èŠ‚ï¼Œæ‰€ä»¥Tcacheç¼“å­˜çš„æ˜¯éL ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/07/08/Pwn/Heap-learning-note/" title="Heap learning note">Heap learning note</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time datetime="2021-07-08T14:33:41.000Z" title="å‘è¡¨äº 2021-07-08 22:33:41">2021-07-08</time></span></div><div class="content">ç›®å‰æ­£åœ¨å­¦å †ç›¸å…³çš„æ¼æ´åŠåˆ©ç”¨ï¼Œèµ„æ–™å‚è€ƒçš„æ˜¯shellphishæˆ˜é˜Ÿç¼–å†™çš„how2heap: A repository for learning various heap exploitation techniques.ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±çš„å­¦ä¹ è¿‡ç¨‹ã€‚

Ubuntu 16.04
python2

0x00  prepare123git clone https://github.com/shellphish/how2heap.gitcd how2heapmake

0x01 basicfirst_fitâ€‹	å³æ“ä½œç³»ç»Ÿå­¦è¿‡çš„é¦–æ¬¡é€‚åº”(æœ€å¿«é€‚åº”)ç®—æ³•ï¼Œå†åŠ ä¸Šbinä¸­FIFOçš„é¡ºåºï¼Œæ‰€ä»¥åœ¨ç”³è¯·å¤§å°æ¥è¿‘çš„å †çš„æ—¶å€™ï¼Œä¼šä¼˜å…ˆåˆ†é…åˆ°æœ€æ—©freeçš„chunkã€‚
calc_tcache_idxâ€‹	åœ¨Glibcçš„2.26ä¸­ æ–°å¢äº†Tcacheæœºåˆ¶ è¿™æ˜¯ptmalloc2çš„ç¼“å­˜æœºåˆ¶,cacheä¸ºæ¯ä¸ªçº¿ç¨‹éƒ½é¢„ç•™äº†è¿™æ ·ä¸€ä¸ªç‰¹æ®Šçš„binsï¼Œ binçš„æ•°é‡æ˜¯64ä¸ª æ¯ä¸ªbinä¸­æœ€å¤šç¼“å­˜7ä¸ªchunkã€‚åœ¨64ä½ç³»ç»Ÿä¸Šä»¥0x10çš„å­—èŠ‚é€’å¢ï¼Œä»24é€’å¢åˆ°1032å­—èŠ‚ã€‚32ä½ç³»ç»Ÿä¸Šåˆ™ä»12åˆ°512å­—èŠ‚ï¼Œæ‰€ä»¥Tcacheç¼“å­˜çš„æ˜¯éL ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2021/07/01/Reverse/Brute-Force-in-Reverse-Engineer/" title="Brute Force in Reverse Engineer">Brute Force in Reverse Engineer</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">å‘è¡¨äº</span><time datetime="2021-07-01T08:08:30.000Z" title="å‘è¡¨äº 2021-07-01 16:08:30">2021-07-01</time></span></div><div class="content">   æœ€è¿‘æ¯”èµ›é‡Œç»å¸¸è§åˆ°éœ€è¦çˆ†ç ´çš„é¢˜ç›®ï¼Œè®°å½•ä¸€ä¸‹å¸¸è§çš„çˆ†ç ´æ–¹æ³•ã€‚
æµ‹è¯•å¹³å°ï¼šRyzen R7-5800H
task1.cä»¥ä¸‹é¢è¿™ä¸ªè‡ªå·±å†™çš„ç®€å•å¼‚æˆ–åŠ å¯†ä¸ºä¾‹ï¼Œè§„å®šè¾“å…¥ä¸º6ä½æ•°å­—ã€‚
123456789101112131415161718192021void encrypt(char *Src)&#123;    int len = strlen(Src);      while (len--)        Src[len] ^= 0x6B; &#125;int main()&#123;    const char cipher[] = &quot;ZZ_^Z_&quot;;    char buf[10];    scanf(&quot;%s&quot;, buf);                  encrypt(buf);                  if(strcmp(buf,cipher))    &#123;        printf(&quot;Wrong\n&quot;);        exit(0);    &#125;       printf(&quot; ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2024/05/04/Zav4zFVukLJMBKI.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">devoke</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">2</div></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/03/03/Reverse/lighthouse%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" title="lighthouse ä½¿ç”¨æŒ‡å—">lighthouse ä½¿ç”¨æŒ‡å—</a><time datetime="2024-03-03T15:45:14.000Z" title="å‘è¡¨äº 2024-03-03 23:45:14">2024-03-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/19/Life/ES%E5%B0%8F%E4%B8%BB%E6%9C%BA%E6%8A%98%E8%85%BE%E8%AE%B0/" title="ESå°ä¸»æœºæŠ˜è…¾è®°">ESå°ä¸»æœºæŠ˜è…¾è®°</a><time datetime="2024-02-19T03:05:01.000Z" title="å‘è¡¨äº 2024-02-19 11:05:01">2024-02-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/03/20/WriteUp/HFCTF2022-RE/" title="HFCTF2022 RE">HFCTF2022 RE</a><time datetime="2022-03-20T12:04:53.000Z" title="å‘è¡¨äº 2022-03-20 20:04:53">2022-03-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/03/09/WriteUp/%E7%AE%80%E7%AE%80%E5%8D%95%E5%8D%95%E5%AF%86%E7%A0%81%E9%A2%98/" title="ç®€ç®€å•å•å¯†ç é¢˜">ç®€ç®€å•å•å¯†ç é¢˜</a><time datetime="2022-03-09T12:08:44.000Z" title="å‘è¡¨äº 2022-03-09 20:08:44">2022-03-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/02/03/Python/Python-multiprocess-learning/" title="Python multiprocess learning">Python multiprocess learning</a><time datetime="2022-02-03T06:25:30.000Z" title="å‘è¡¨äº 2022-02-03 14:25:30">2022-02-03</time></div></div></div></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>æ ‡ç­¾</span></div><div class="card-tag-cloud"><a href="/tags/Android/" style="font-size: 1.1em; color: #999">Android</a> <a href="/tags/CTF/" style="font-size: 1.1em; color: #999">CTF</a> <a href="/tags/Crypto/" style="font-size: 1.23em; color: #999ea6">Crypto</a> <a href="/tags/Fuzzing/" style="font-size: 1.1em; color: #999">Fuzzing</a> <a href="/tags/IDA%E6%8F%92%E4%BB%B6/" style="font-size: 1.1em; color: #999">IDAæ’ä»¶</a> <a href="/tags/IoT/" style="font-size: 1.1em; color: #999">IoT</a> <a href="/tags/Misc/" style="font-size: 1.1em; color: #999">Misc</a> <a href="/tags/OLLVM/" style="font-size: 1.1em; color: #999">OLLVM</a> <a href="/tags/Pwn/" style="font-size: 1.37em; color: #99a4b2">Pwn</a> <a href="/tags/Python/" style="font-size: 1.23em; color: #999ea6">Python</a> <a href="/tags/Reverse/" style="font-size: 1.5em; color: #99a9bf">Reverse</a> <a href="/tags/WriteUp/" style="font-size: 1.5em; color: #99a9bf">WriteUp</a> <a href="/tags/unidbg/" style="font-size: 1.1em; color: #999">unidbg</a> <a href="/tags/%E5%87%89%E7%BB%8F/" style="font-size: 1.1em; color: #999">å‡‰ç»</a> <a href="/tags/%E6%BC%8F%E6%B4%9E/" style="font-size: 1.1em; color: #999">æ¼æ´</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 1.1em; color: #999">ç¬”è®°</a> <a href="/tags/%E8%A3%85%E6%9C%BA/" style="font-size: 1.1em; color: #999">è£…æœº</a></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2024/02/20/i5askw6xYVRKDtE.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By devoke</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/"></script><script src="/"></script><script src="/"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, ))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('/').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["æ— è·¯è¿œå¾ã€‚","äººç±»çš„èµæ­Œæ˜¯å‹‡æ°”çš„èµæ­Œï¼Œäººç±»çš„ä¼Ÿå¤§æ˜¯å‹‡æ°”çš„ä¼Ÿå¤§ã€‚"])
  } else {
    document.getElementById("subtitle").textContent = "æ— è·¯è¿œå¾ã€‚"
  }
}
typedJSFn.run(subtitleType)</script></div></div></body></html>